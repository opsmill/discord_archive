[{"thread":{"id":"1421766698918346763","type":11,"last_message_id":"1422218965501087775","flags":0,"guild_id":"1212332642801025064","name":"How can I get all the change log from a closed proposed change using graphql?","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"846244078575943680","thread_metadata":{"archived":true,"archive_timestamp":"2025-10-29T13:52:22.134000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-09-28T07:53:16.170000+00:00"},"message_count":12,"member_count":5,"total_message_sent":12,"applied_tags":["1301915943663960064","1322475882421555200"]},"messages":[{"type":0,"content":"<@846244078575943680> Yes you can use normal webhook or custom webhooks.","mentions":[{"id":"846244078575943680","username":"jinh0e","avatar":"64dabc243532002393161796f39770a0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Jin","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-09-29T13:50:24.926000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1422218965501087775","channel_id":"1421766698918346763","author":{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":11},{"type":0,"content":"<@811281824768458793> this is actually being fixed in 1.5: https://github.com/opsmill/infrahub/pull/7285","mentions":[{"id":"811281824768458793","username":"matej3653","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Matej Lanca","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}}],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/opsmill/infrahub/pull/7285","title":"Fix payload for transform webhook to align with other webhooks by o...","description":"Fixes #6815\n\nSummary by CodeRabbit\n\n\nBug Fixes\n\nStandardized webhook payload structure for transform-based webhooks to match standard/custom webhooks. The original payload is now nested under data....","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/7027ee0c0fc3163cab68f949e44a88ab242f00bd48b79e7b5bd07960baf80f0a/opsmill/infrahub/pull/7285","proxy_url":"https://images-ext-1.discordapp.net/external/iBK-rJYDifkjjzp8jCsuFoqLWdE97btD90Ve6GbDSgo/https/opengraph.githubassets.com/7027ee0c0fc3163cab68f949e44a88ab242f00bd48b79e7b5bd07960baf80f0a/opsmill/infrahub/pull/7285","width":1200,"height":600,"description":"Fixes #6815\n\nSummary by CodeRabbit\n\n\nBug Fixes\n\nStandardized webhook payload structure for transform-based webhooks to match standard/custom webhooks. The original payload is now nested under data....","flags":0},"content_scan_version":2}],"timestamp":"2025-09-29T13:49:38.909000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1422218772491669524","channel_id":"1421766698918346763","author":{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":10,"reactions":[{"emoji":{"id":null,"name":"❤️"},"count":2,"count_details":{"burst":0,"normal":2},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"on the custom webhook topic, do not miss this note from documentation like i did\n\n```\nThe data passed into a normal Python transformation will typically be the result of the GraphQL query, but webhooks execute the transform by passing in the webhook data instead.\n\nCurrently, it is required to define a GraphQL query to be defined on a transform regardless of whether it is used for a custom webhook or not. In the future, this will not be required.\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-09-29T13:37:08.475000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1422215624943210497","channel_id":"1421766698918346763","author":{"id":"811281824768458793","username":"matej3653","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Matej Lanca","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":9,"reactions":[{"emoji":{"id":null,"name":"❤️"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"hmmm.... I haven't dive deep with transformation yet.\n\nSo I guess you referring to Custom Webhook with following config:\n\nEvent Type: infrahub.proposed_change.rejected\nTransformation: Somehow generate an artifact that can be send over to Ansible EDA to revert back those configuration","mentions":[],"mention_roles":[],"attachments":[{"id":"1422213776249196594","filename":"Screenshot_2025-09-29_at_9.24.41_PM.png","size":116196,"url":"https://cdn.discordapp.com/attachments/1421766698918346763/1422213776249196594/Screenshot_2025-09-29_at_9.24.41_PM.png?ex=6933870b&is=6932358b&hm=54cce2cc8f65f6e78b41c484a5d3d1b5ff412970a9ce5642e13feb8cd9550d84&","proxy_url":"https://media.discordapp.net/attachments/1421766698918346763/1422213776249196594/Screenshot_2025-09-29_at_9.24.41_PM.png?ex=6933870b&is=6932358b&hm=54cce2cc8f65f6e78b41c484a5d3d1b5ff412970a9ce5642e13feb8cd9550d84&","width":820,"height":1938,"content_type":"image/png","content_scan_version":2,"placeholder":"OwgGAwIAZ2l4eJtTiHCHCcg=","placeholder_version":1,"title":"Screenshot 2025-09-29 at 9.24.41 PM"}],"embeds":[],"timestamp":"2025-09-29T13:29:47.759000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1422213776446459941","channel_id":"1421766698918346763","author":{"id":"846244078575943680","username":"jinh0e","avatar":"64dabc243532002393161796f39770a0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Jin","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":8},{"type":0,"content":"Thank you for explaning the usecase in detail this helps massively with the context for what you're trying to achieve. So yes you might want to look into the webhooks to trigger EDA. \n\nAnother one to play around with would be to have an event rule that triggers a generator when a proposed change has been updated. \n\nFor example you could have a model describing the change in the infrastrucutre and use this to track the \"State\" of the environment. When the proposed change is rejected a generator can be triggered to update the model that tracks this change and fire webhooks etc.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-09-29T13:04:23.237000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1422207382137602048","channel_id":"1421766698918346763","author":{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":7},{"type":0,"content":"Yes, I’m aware that the purpose of proposed changes is to apply configurations only after they’ve been accepted, and I do understand that workflow.\n\nWhat I’m trying to build is a proof of concept (POC) for detecting configuration drift using IP Fabric’s daily snapshots. When drift is detected, Ansible EDA is triggered to compare the latest snapshot with the previous one. If changes are found, Infra-sync runs and generates a proposed change.\n\nFrom there, two scenarios can occur:\n\nScenario 1: A device configuration was intentionally modified for a valid reason. The reviewer accepts the proposed change, which is then merged.\n\nScenario 2: A device configuration was unintentionally modified. The reviewer closes the proposed change instead of merging it. An Ansible EDA listener detects the “close” action and triggers a workflow to revert the configuration back to the intended state.\n\nI deliberately chose the “close” action over “reject”, because “reject” leaves the proposed change in an Open state. What I want is for the change to move to the Closed state so we can move on.\n\nThis workflow may not be ideal, so I’m happy to bounce around ideas and hear alternative approaches.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-09-29T12:41:24.605000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1422201599735889951","channel_id":"1421766698918346763","author":{"id":"846244078575943680","username":"jinh0e","avatar":"64dabc243532002393161796f39770a0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Jin","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"In my opinion, the purpose of proposed changes is to apply configurations only after they've been accepted. Following Alex's suggestion, you could set up events on the main branch so that Ansible only deploys changes that have been merged there. This way, rejected proposals are simply discarded without ever being applied, so there's no need to revert anything. While the CI process on the proposed change itself can be used to validate the changes before merging (dry run, separate testing environment, and so on)","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-09-29T11:44:46.352000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1422187346429874247","channel_id":"1421766698918346763","author":{"id":"811281824768458793","username":"matej3653","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Matej Lanca","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":5},{"type":0,"content":"Another option would be to use Anisble EDA to trigger a specific playbook run based on the infrahub event for `infrahub.proposed_change.rejected`.","mentions":[],"mention_roles":[],"attachments":[{"id":"1422168746382065756","filename":"Screenshot_2025-09-29_at_11.30.07.png","size":83043,"url":"https://cdn.discordapp.com/attachments/1421766698918346763/1422168746382065756/Screenshot_2025-09-29_at_11.30.07.png?ex=693405db&is=6932b45b&hm=03c6bd2cc48cd8de97aeadddfcdf744d5af664f391674417006ad7edb3b8e33c&","proxy_url":"https://media.discordapp.net/attachments/1421766698918346763/1422168746382065756/Screenshot_2025-09-29_at_11.30.07.png?ex=693405db&is=6932b45b&hm=03c6bd2cc48cd8de97aeadddfcdf744d5af664f391674417006ad7edb3b8e33c&","width":427,"height":1037,"content_type":"image/png","original_content_type":"image/png","content_scan_version":2,"placeholder":"O/gFCwAQZGloeYemaHjQowE=","placeholder_version":1,"title":"Screenshot 2025-09-29 at 11.30.07"}],"embeds":[],"timestamp":"2025-09-29T10:30:51.798000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1422168746562424843","channel_id":"1421766698918346763","author":{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"Hello,\n\nWe would recommend that you apply configuration to devices that has been generated from the `main` branch so changes that have been `approved` and `merged`. There are use cases where other branch information may be applied to devices but typically this is done for testing/validation purposes.\n\n```\nquery GetProposedChange($proposedChangeId: [ID!]) {\n  CoreProposedChange(ids: $proposedChangeId) {\n    edges {\n      node {\n        id\n        source_branch {\n          value\n        }\n        display_label\n        state {\n          value\n        }\n        rejected_by {\n          edges {\n            node {\n              display_label\n            }\n          }\n        }\n        name {\n          value\n        }\n      }\n    }\n  }\n}\n```\n\nIf you do need this information then yes you would need this query.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-09-29T10:29:16.299000+00:00","edited_timestamp":"2025-09-29T10:32:00.341000+00:00","flags":0,"components":[],"id":"1422168346010456144","channel_id":"1421766698918346763","author":{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":4,"content":"How can I get all the change log from a closed proposed change using graphql?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-09-28T08:05:00.421000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1421769652761137162","channel_id":"1421766698918346763","author":{"id":"846244078575943680","username":"jinh0e","avatar":"64dabc243532002393161796f39770a0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Jin","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"This is the closest I can get so far.","mentions":[],"mention_roles":[],"attachments":[{"id":"1421767498021343262","filename":"Screenshot_2025-09-28_at_3.56.02_PM.png","size":267375,"url":"https://cdn.discordapp.com/attachments/1421766698918346763/1421767498021343262/Screenshot_2025-09-28_at_3.56.02_PM.png?ex=6933e1aa&is=6932902a&hm=3e18b4a66535ceb1a7887a38170fac17f092e822f5651964df50dbfe715c79e0&","proxy_url":"https://media.discordapp.net/attachments/1421766698918346763/1421767498021343262/Screenshot_2025-09-28_at_3.56.02_PM.png?ex=6933e1aa&is=6932902a&hm=3e18b4a66535ceb1a7887a38170fac17f092e822f5651964df50dbfe715c79e0&","width":2108,"height":1266,"content_type":"image/png","content_scan_version":2,"placeholder":"/QcCBIBPkndkeIdoioc/UzjApg==","placeholder_version":1,"title":"Screenshot 2025-09-28 at 3.56.02 PM"}],"embeds":[],"timestamp":"2025-09-28T07:56:26.741000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1421767498231189586","channel_id":"1421766698918346763","author":{"id":"846244078575943680","username":"jinh0e","avatar":"64dabc243532002393161796f39770a0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Jin","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"I have the Node ID to get to the specific proposed changed from event","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-09-28T07:55:34.335000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1421767278424490086","channel_id":"1421766698918346763","author":{"id":"846244078575943680","username":"jinh0e","avatar":"64dabc243532002393161796f39770a0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Jin","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"Use case is I want Ansible to revert back intented hostname (eventually device config) if reviewer choose to close (reject) this proposed change. Or is there a better way to pass these informaton to Ansible?","mentions":[],"mention_roles":[],"attachments":[{"id":"1421766699471999076","filename":"Screenshot_2025-09-28_at_3.45.01_PM.png","size":124144,"url":"https://cdn.discordapp.com/attachments/1421766698918346763/1421766699471999076/Screenshot_2025-09-28_at_3.45.01_PM.png?ex=6933e0ec&is=69328f6c&hm=9656535efbea6bd63fc39b8ac45ac7683cc1e5824fe9ed8685ec102fe48c972e&","proxy_url":"https://media.discordapp.net/attachments/1421766698918346763/1421766699471999076/Screenshot_2025-09-28_at_3.45.01_PM.png?ex=6933e0ec&is=69328f6c&hm=9656535efbea6bd63fc39b8ac45ac7683cc1e5824fe9ed8685ec102fe48c972e&","width":2016,"height":714,"content_type":"image/png","content_scan_version":2,"placeholder":"/fcBAoBle8QJpmmwLz74oMQ=","placeholder_version":1,"title":"Screenshot 2025-09-28 at 3.45.01 PM"}],"embeds":[],"timestamp":"2025-09-28T07:53:16.170000+00:00","edited_timestamp":"2025-09-28T08:05:41.879000+00:00","flags":0,"components":[],"id":"1421766698918346763","channel_id":"1421766698918346763","author":{"id":"846244078575943680","username":"jinh0e","avatar":"64dabc243532002393161796f39770a0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Jin","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]