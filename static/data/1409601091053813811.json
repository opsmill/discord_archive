[{"thread":{"id":"1409601091053813811","type":11,"last_message_id":"1410506012984737814","flags":0,"guild_id":"1212332642801025064","name":"Python transform referencing other modules and files","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"918504524610695168","thread_metadata":{"archived":true,"archive_timestamp":"2025-09-27T06:13:33.501000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-08-25T18:11:29.229000+00:00"},"message_count":9,"member_count":5,"total_message_sent":10,"applied_tags":["1301916056205656276"]},"messages":[{"type":0,"content":"I like the custom python package as well, just be sure to run the same version of the python SDK that infrahub is running internally \nor even better, put the Python SDK as a dev deps and only install the non dev deps inside the container","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-08-28T06:07:19.430000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1410506012984737814","channel_id":"1409601091053813811","author":{"id":"695690467056025690","username":"dgarros","avatar":"67171294847dca2ce3ac938f5bca0443","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Damien","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":9},{"type":0,"content":"nice work <@867799355921268767>","mentions":[{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-08-26T16:39:48.009000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1409940405130235945","channel_id":"1409601091053813811","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":8},{"type":0,"content":"I like to use a custom image with my own package installed. Works well so far and organise and test my code like always \nhttps://github.com/ubaumann/demo_infrahub_pydantify/tree/main/setup/infrahub-worker","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/ubaumann/demo_infrahub_pydantify/tree/main/setup/infrahub-worker","title":"demo_infrahub_pydantify/setup/infrahub-worker at main Â· ubaumann/d...","description":"Simple example how infrahub can generate gNMI payload using pydantic models generated with pydantify - ubaumann/demo_infrahub_pydantify","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/423b0cd7b7ccc41bec4a8bff285e8f002c875720aac2a7d44713f4c84d1c398a/ubaumann/demo_infrahub_pydantify","proxy_url":"https://images-ext-1.discordapp.net/external/hJXGAiwg32Lipl1PKEX-pP4VVNSxgGgIy4vDOirEFGY/https/opengraph.githubassets.com/423b0cd7b7ccc41bec4a8bff285e8f002c875720aac2a7d44713f4c84d1c398a/ubaumann/demo_infrahub_pydantify","width":1200,"height":600,"description":"Simple example how infrahub can generate gNMI payload using pydantic models generated with pydantify - ubaumann/demo_infrahub_pydantify","flags":0},"content_scan_version":2}],"timestamp":"2025-08-26T16:30:25.973000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1409938047780262040","channel_id":"1409601091053813811","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":7,"reactions":[{"emoji":{"id":null,"name":"ðŸ‘"},"count":2,"count_details":{"burst":0,"normal":2},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0},{"emoji":{"id":null,"name":"ðŸš€"},"count":2,"count_details":{"burst":0,"normal":2},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0},{"emoji":{"id":null,"name":"ðŸ‘ðŸ»"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0},{"emoji":{"id":null,"name":"â˜ðŸ»"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"that's working, thanks!","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-08-26T15:32:27.735000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1409923458992963707","channel_id":"1409601091053813811","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"yes! apologies, I should RTFM better ðŸ™‚","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-08-26T14:55:33.507000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1409914171847479348","channel_id":"1409601091053813811","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":5},{"type":0,"content":"Does this help? https://docs.infrahub.app/topics/transformation#python-transform-accessing-local-files","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://docs.infrahub.app/topics/transformation","title":"Transformation | Infrahub Documentation","description":"A Transformation is a generic plugin to transform a dataset into a different format to simplify it's ingestion by third-party systems.","content_scan_version":2}],"timestamp":"2025-08-26T14:53:16.634000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1409913597760634900","channel_id":"1409601091053813811","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"I guess I'm missing how best to structure things when you want to split stuff up into multiple files/modules.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-08-26T14:39:10.973000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1409910050801061949","channel_id":"1409601091053813811","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"Hey Benoit,\n\nNo worries, in my `.infrahub.yml` I have:\n\n```\npython_transforms:\n  - name: device_transform_yaml\n    class_name: DeviceTransformYaml\n    file_path: transforms/device_transform.py\n```\n\n..so `device_transform.py` lives in a sub directory called `transforms`. Here's the relevant code sninppet  in `device_transform.py` which creates a device config in YAML:\n\n```\nclass Device:\n    def __init__(self, device_data: DeviceData) -> None:\n        self._device_data: DeviceData = device_data\n        self._device_config: BaseDeviceConfigModel = DeviceConfig.create(device_data)\n        self.name: str = device_data.name\n        self.type: str = device_data.type\n\n    @classmethod\n    def create(cls, data: dict[str, Any]) -> Self:\n        infra_device: dict[str, Any] = data[\"InfraDevice\"][\"edges\"][0][\"node\"]\n        device_data: DeviceData = DeviceData.create(infra_device=infra_device)\n        return cls(device_data=device_data)\n\n    def yaml_config(self) -> dict[str, Any]:\n        config = self._device_config.dict(by_alias=True, exclude_defaults=True)\n\n        with open(\"templates/base.yaml\", \"r\") as file:\n            template = yaml.safe_load(file)\n\n        return yaml.dump(deep_merge(template, config), sort_keys=False)\n\n\nclass DeviceTransformYaml(InfrahubTransform):\n    query: str = \"device_query\"\n    url: str = \"device-yaml\"\n\n    async def transform(self, data: dict[str, Any]) -> dict[str, Any]:\n        device: Device = Device.create(data)\n        return device.yaml_config()\n```\n\nIn `yaml_config()` I'm trying to read a YAML file from `templates/base.yaml` but it's not working. I tried a relative import like `../templates/base.yaml` and I also tried moving the `base.yaml` to the `transforms` directory but no luck.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-08-26T14:38:33.236000+00:00","edited_timestamp":"2025-08-26T14:49:55.763000+00:00","flags":0,"components":[],"id":"1409909892520874158","channel_id":"1409601091053813811","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"Hey Dan\n\nSorry for the late reply.\nBoth should be possible, do you mind sharing how you are doing it ?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-08-26T14:13:08.427000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1409903497008119922","channel_id":"1409601091053813811","author":{"id":"1133022375051542558","username":"shabear_dis","avatar":"e5046d674427373d76e2dde9dc74feb5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Benito","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"Hi team,\n\nI'm playing with python transforms and I'm wondering:\n\n1. Is it possible to import other modules from either the same directory as the transform or another adjacent directory?\n2. Is it possible to read a file from the same directory or another adjacent directory?\n\nI've failed at both of these so far but maybe I'm missing something. I just get errors like\n\n```\nTransformError(repository_name=self.name, commit=commit, location=location, message=str(exc)) from exc infrahub.exceptions.TransformError: [Errno 2] No such file or directory: 'template_leaf.yaml'\n```\n\nThanks,\n\nDan","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-08-25T18:11:29.229000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1409601091053813811","channel_id":"1409601091053813811","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]