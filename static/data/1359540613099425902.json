[{"thread":{"id":"1359540613099425902","type":11,"last_message_id":"1361451067828736081","flags":0,"guild_id":"1212332642801025064","name":"Connecting Infrahub to Private Gitlab Repository","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"1352654639522123826","thread_metadata":{"archived":true,"archive_timestamp":"2025-05-14T21:25:22.528000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-04-09T14:49:01.206000+00:00"},"message_count":28,"member_count":6,"total_message_sent":28,"applied_tags":["1301915235380363266"]},"messages":[{"type":0,"content":"It should work just by creating the credential. If it doesn't, then I would consider that as a bug.\nWhat you are doing should not be the way this is supposed to be done. \nWould still be interested in the above requested logs and query output, if it is still the same Infrahub instance.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-14T21:20:29.108000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1361451067828736081","channel_id":"1359540613099425902","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":27,"reactions":[{"emoji":{"id":null,"name":"☝️"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"Probably not recommended to do it this way, but only way I could get it to work","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-14T20:39:05.263000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1361440649827717280","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":26},{"type":0,"content":"Hey Wim - appreciate it. So kind of jenky how I got this to work... but I did get it to work in the end this morning. What I did was create a new repo (read-write), and for the Location, I put it in like this:\n\n```https://dummy_username:<personal-access-token>@gitlab.example.com/infrahub/infrahub.git```\n\nAnd I didn't select any credentials for it at all. It's connecting up now just fine (Operational State = Online).","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-14T20:38:12.887000+00:00","edited_timestamp":"2025-04-14T20:38:35.014000+00:00","flags":0,"components":[],"id":"1361440430146978037","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":25},{"type":0,"content":"It also seems to work with username/password. But not sure if that works for all the setups, and if that's what you should really do. Project access tokens do seem to be the best option imo.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T22:17:00.373000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360015740362690611","channel_id":"1359540613099425902","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":24},{"type":0,"content":"<@1352654639522123826>  happy to setup a quick meeting if you can't get it to work.","mentions":[{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T22:11:04.833000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360014249119846471","channel_id":"1359540613099425902","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":23},{"type":0,"content":"So the best option actually is to use a project access token. It will scope the token to only  the specific project.\nThe scope should be `read_repository` for a read-only repository and `read_repository` and `write_repository` for a regular repository and it will need to have the `developer` role.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T22:10:18.997000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360014056869593168","channel_id":"1359540613099425902","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":22},{"type":0,"content":"Can you send us the output of this graphql query, you can use the GraphQL sandbox to execute it.\n(Click on 3 dots next to your username in the bottom left in Infrahub)\n```\nquery {\n  CoreReadOnlyRepository {\n    edges {\n      node {\n        location {\n          value \n        }\n        credential {\n          node {\n            id\n            name {\n              value\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\nIt would also be useful to get the logs of the infrahub-server and task-worker containers and the version of Infrahub that you are running.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:39:06.371000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360006202507006013","channel_id":"1359540613099425902","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":21},{"type":19,"content":"oh nice yes, I just quickly tested it with a deploy token and works like a charm -> I will switch to that as they do not expire; thanks","mentions":[{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:29:15.657000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360003724873039964","channel_id":"1359540613099425902","author":{"id":"1300537046833692725","username":"simli133","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Simon linder","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"message_reference":{"type":0,"channel_id":"1359540613099425902","message_id":"1360001802174599229","guild_id":"1212332642801025064"},"position":20,"referenced_message":{"type":0,"content":"`read_repository` should be sufficient for a read-only repository","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:21:37.250000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360001802174599229","channel_id":"1359540613099425902","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":18}},{"type":0,"content":"<@370964598284746752> I just tested exposing the task-manager on port 4200 with my docker-compose.override.yml file. \n\nOn my web browser, this is all that shows up:\n{\"detail\": \"Not Found\"}","mentions":[{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:21:54.739000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360001875528782006","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":19},{"type":0,"content":"`read_repository` should be sufficient for a read-only repository","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:21:37.250000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360001802174599229","channel_id":"1359540613099425902","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":18},{"type":0,"content":"I did a quick test. I created an impersonation token, with the following scopes `read_repository, write_repository`\n\nI then added the repository and did provide my username and the impersonation token as the password and it works as expected.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:20:50.214000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360001604891181257","channel_id":"1359540613099425902","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":17},{"type":0,"content":"Oh and if you are using Access-Token on the git repo not your user, make sure to select \"Developer\" as Role","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:20:20.850000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360001481729773759","channel_id":"1359540613099425902","author":{"id":"1300537046833692725","username":"simli133","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Simon linder","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":16},{"type":0,"content":"Interesting. I just tested it with infrahubctl as well, and getting the same error ('Unable to correctly lookup credentials for repository')","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:17:58.077000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1360000882896273718","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":15},{"type":19,"content":"Indeed I connected infrahub many times to a private repository. With older versions (v1.0) of infrahub you had to add a dummy username and the access token. I normaly did it using the infrahubctl ```infrahubctl repository add GitlabInfrahub https://gitlab.ost.ch/ins-stud/sa-ba/sa-hs24-iac/testinfrahubintegration.git --username \"Infrahub\" --password \"<access-token>\"```. But now with infrahub version 1.2 you can even leave the username empty. (I did it last week, but I went in the GUI to \"add Git Repository\" -> \"authenticaction\", added the git authentication there. So the other way round.) \nOther than that I can only advice you to doublecheck the rights of your access token, I suppose it needs at least ```api, read_api, read_repository``` for the Read-Only Repository.","mentions":[{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T21:01:52.430000+00:00","edited_timestamp":"2025-04-10T21:04:59.440000+00:00","flags":0,"components":[],"id":"1359996832679202826","channel_id":"1359540613099425902","author":{"id":"1300537046833692725","username":"simli133","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Simon linder","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"message_reference":{"type":0,"channel_id":"1359540613099425902","message_id":"1359656471356379298","guild_id":"1212332642801025064"},"position":14,"referenced_message":{"type":0,"content":"<@1300537046833692725> You connected Infrahub to a private GitLab repo. Do you have any advice?","mentions":[{"id":"1300537046833692725","username":"simli133","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Simon linder","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T22:29:23.967000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359656471356379298","channel_id":"1359540613099425902","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":4}},{"type":0,"content":"nginx.conf\n```\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n    server_tokens off;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_prefer_server_ciphers on;\n    ssl_ciphers <truncated>\n\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    add_header X-XSS-Protection \"1; mode=block\" always;\n    add_header X-Content-Type-Options \"nosniff\" always;\n\n    upstream infrahub {\n        server infrahub-server:8000;\n    }\n\n    # Main server block for port 8000\n    server {\n        listen 8000 ssl;\n        server_name infrahub.example.com 10.2.3.4;\n\n        ssl_certificate /etc/nginx/ssl/infrahub.example.com.cer;\n        ssl_certificate_key /etc/nginx/ssl/infrahub.example.com.pem;\n\n        ssl_session_timeout 1d;\n        ssl_session_cache shared:SSL:50m;\n        ssl_session_tickets off;\n\n        location / {\n            proxy_pass http://infrahub;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n\n            proxy_connect_timeout 60s;\n            proxy_send_timeout 60s;\n            proxy_read_timeout 60s;\n        }\n    }\n\n    # HTTPS redirect from 443 to 8000\n    server {\n        listen 443 ssl;\n        server_name infrahub.example.com 10.2.3.4;\n\n        ssl_certificate /etc/nginx/ssl/infrahub.example.com.cer;\n        ssl_certificate_key /etc/nginx/ssl/infrahub.example.com.pem;\n\n        return 301 https://$server_name:8000$request_uri;\n    }\n\n    # HTTP redirect from 80 to 8000\n    server {\n        listen 80;\n        server_name infrahub.example.com 10.2.3.4;\n\n        return 301 https://$server_name:8000$request_uri;\n    }\n}\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T20:50:26.657000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359993956338897146","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":13},{"type":0,"content":"docker-compose.override.yml\n```\nservices:\n  nginx:\n    image: nginx:latest\n    ports:\n      - \"8000:8000\"\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n      - ./ssl:/etc/nginx/ssl:ro\n    depends_on:\n      - infrahub-server\n\n  task-worker:\n    user: root\n    environment:\n      - http_proxy=http://10.1.2.3:8080\n      - https_proxy=http://10.1.2.3:8080\n      - HTTP_PROXY=http://10.1.2.3:8080\n      - HTTPS_PROXY=http://10.1.2.3:8080\n      - no_proxy=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,localhost,127.0.0.1,infrahub-server,database,message-queue,cache,task-manager\n      - NO_PROXY=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,localhost,127.0.0.1,infrahub-server,database,message-queue,cache,task-manager\n    volumes:\n      - /opt/infrahub/custom-ca.crt:/usr/local/share/ca-certificates/custom-ca.crt:ro\n    command: >\n      sh -c \"\n        update-ca-certificates &&\n        git config --global http.proxy http://10.1.2.3:8080 &&\n        prefect worker start --type infrahubentasync --pool infrahub-worker --with-healthcheck\"\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T20:49:40.267000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359993761764999209","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":12},{"type":0,"content":"It should be accessible via UI (if you exposed 4200) on your setup, but the API is a bit harder to navigate with all the references.\n\nHow did you spin this up?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T19:50:47.827000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359978945638043870","channel_id":"1359540613099425902","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":11},{"type":0,"content":"This is output while docker exec'd into one of the task-workers. The flow ID's don't match because I tried to add the repo again and the output above is from the new flow.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T19:01:28.602000+00:00","edited_timestamp":"2025-04-10T19:02:45.222000+00:00","flags":0,"components":[],"id":"1359966533748789338","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":10},{"type":0,"content":"Sorry - I think this is what you're asking for. Correct me if I'm wrong!\n\nroot@XXXXXXXXXXXX:/source# curl -v http://task-manager:4200/runs/flow-run/0f5dad68-2010-4cbf-8271-ad9b639da7cc\n* Uses proxy env variable no_proxy == '10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,localhost,127.0.0.1,infrahub-server,database,message-queue,cache,task-manager'\n*   Trying 172.19.0.6:4200...\n* Connected to task-manager (172.19.0.6) port 4200 (#0)\n> GET /runs/flow-run/0f5dad68-2010-4cbf-8271-ad9b639da7cc HTTP/1.1\n> Host: task-manager:4200\n> User-Agent: curl/7.88.1\n> Accept: */*\n> \n< HTTP/1.1 404 Not Found\n< date: Thu, 10 Apr 2025 18:58:03 GMT\n< server: uvicorn\n< content-length: 22\n< content-type: application/json\n< \n* Connection #0 to host task-manager left intact\n{\"detail\":\"Not Found\"}","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T19:01:08.804000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359966450709954640","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":9},{"type":0,"content":"How would I go about looking at the specific flow within the task manager? Unfortunately, it never actually adds the repository to the system, so I can't look at the detailed view of it.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T18:38:13.055000+00:00","edited_timestamp":"2025-04-10T18:38:27.702000+00:00","flags":0,"components":[],"id":"1359960680400289794","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":8},{"type":0,"content":"Do you have the task manager exposed and can look at that specific flow to see if any of that provides additional information? There could potentially be information within the Infrahub UI when looking at the repository and the `Tasks` tab in the repository's detailed view.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T17:38:09.762000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359945567093915829","channel_id":"1359540613099425902","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":7},{"type":0,"content":"I tested with both my actual gitlab username and dummy username and still same result.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T16:07:52.965000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359922847400591441","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"I only see new logs show up on the task-workers. Here's what pops up when I try to add the repo (using credential with personal access token):\n\n/usr/local/lib/python3.12/site-packages/fastapi/encoders.py:324: RuntimeWarning: coroutine 'Redis.execute_command' was never awaited\n  data = dict(obj)\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\n2025-04-10T16:01:06.100506Z [info     ] View at http://task-manager:4200/runs/flow-run/8c962c30-1393-4210-aaf6-ac1091e8c104 [prefect.engine] request_id=089da236828743edbd028bb91a921201 routing_key=git.repository.connectivity\n2025-04-10T16:01:06.140280Z [info     ] Beginning flow run 'Check connectivity for infrahub' for flow 'git-repository-check-connectivity' [prefect.flow_runs] request_id=089da236828743edbd028bb91a921201 routing_key=git.repository.connectivity\n2025-04-10T16:01:06.140558Z [info     ] View at http://task-manager:4200/runs/flow-run/8c962c30-1393-4210-aaf6-ac1091e8c104 [prefect.flow_runs] request_id=089da236828743edbd028bb91a921201 routing_key=git.repository.connectivity\n2025-04-10T16:01:06.841705Z [info     ] Finished in state Completed()  [prefect.flow_runs] request_id=089da236828743edbd028bb91a921201 routing_key=git.repository.connectivity","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-10T16:07:36.658000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359922779004338227","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":5},{"type":0,"content":"<@1300537046833692725> You connected Infrahub to a private GitLab repo. Do you have any advice?","mentions":[{"id":"1300537046833692725","username":"simli133","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Simon linder","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T22:29:23.967000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359656471356379298","channel_id":"1359540613099425902","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"Also, if you add your username or a dummy username, does that work?>","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T21:01:34.706000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359634370473889943","channel_id":"1359540613099425902","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"Do you see any logs on the task workers or API server?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T20:49:40.329000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359631374159581295","channel_id":"1359540613099425902","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"Are there any log files on the task-workers I can view realtime to see exactly what it's failing on?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T20:30:07.836000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359626456367632607","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"If I change the repo in question to a Public repo, Infrahub is able to connect up to it via GUI just fine. Seems to only error when I have to specify credentials.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T20:27:41.281000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359625841671278765","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"Hello all!\n\nContinuing the Infrahub setup process (grueling in my environment, learning a lot) - and am now at the process where I'd like to get Infrahub connected to our private Gitlab instance.\n\nOn the Gitlab instance, I've created a personal access token, and then on Infrahub created a credential with no username, and the password as the personal access token.\n\nNow when I go to \"Create Git Repository\" in Infrahub, specify the repo URL, choose the above credential and click Save, it throws this error:\n\n\"Unable to correctly lookup credentials for repository repo (https://private-gitlab.internal/username/infrahub.git)\"\n\nIf I connect to one of the task-worker containers (sudo docker exec -it infrahub-task-worker-1 bash) and then run this command:\ngit ls-remote **https://oauth2:<personal-access-token>@private-gitlab.internal/username/infrahub.git**\n\nIt successfully connects up just fine. Any ideas as to what could be causing this?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T14:49:01.206000+00:00","edited_timestamp":"2025-04-09T18:29:51.885000+00:00","flags":0,"components":[],"id":"1359540613099425902","channel_id":"1359540613099425902","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]