[{"thread":{"id":"1435592236002705409","type":11,"last_message_id":"1438073992866042007","flags":0,"guild_id":"1212332642801025064","name":"Unable to fetch the peer exception whilst creating a device in a generator","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"918504524610695168","thread_metadata":{"archived":false,"archive_timestamp":"2025-11-05T11:31:01.077000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-11-05T11:31:01.077000+00:00"},"message_count":34,"member_count":3,"total_message_sent":34,"applied_tags":["1301915943663960064"]},"messages":[{"type":0,"content":"OK I think I can work around that by triggering the generator when a particular node is created or updated.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-12T07:52:38.022000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1438073992866042007","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":33},{"type":0,"content":"It doesn't work like that at the moment. The artifact generation task does get started after the generator task has started, but not after the generator has finished.\n\nSo if the generator runs long enough, it could happen that the artifact generation has already started before the generator has finished.\n\nThis is one of the reasons we introduced the feature to disable running generators as part of a PC. So you can trigger generators event based, or manually, before you open a proposed change.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-11T20:37:35.914000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1437904114712576220","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":32},{"type":0,"content":"So this mostly works now, when I raise a PC the generator runs and creates all the devices. However the artifacts do not get created automatically, only if I trigger a \"retry all\" after the devices show up in the data diff. The artifact generation does run the first time but it does not generate anything. Shouldn't it be running after the generator has completed?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-11T20:22:55.156000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1437900420545777764","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":31},{"type":0,"content":"I did, and I confirm it's now working for me üëç","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-11T16:42:15.592000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1437844889789530305","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":30,"reactions":[{"emoji":{"id":null,"name":"üëç"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0},{"emoji":{"id":null,"name":"üéâ"},"count":2,"count_details":{"burst":0,"normal":2},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"<@918504524610695168> if you didn't catch it, 1.5 is now out!","mentions":[{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-11T16:18:26.678000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1437838896489693235","channel_id":"1435592236002705409","author":{"id":"1212726983944052798","username":"pete_crocker","avatar":"2ce15ce78115631a666e77b58952f91e","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Pete Crocker","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":29},{"type":0,"content":"we're working on getting the release out today","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-10T15:08:15.727000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1437458846615470122","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":28,"reactions":[{"emoji":{"id":null,"name":"üöÄ"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"is there a planned date for the 1.5 release? (currently working on a PoC so would  be great to factor it in to my timeline)","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-10T12:09:37.018000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1437413889091436554","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":27},{"type":0,"content":"thanks for the feedback. Once 1.5 is out I'll upgrade and test it again.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-10T11:57:50.170000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1437410924356042793","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":26},{"type":0,"content":"The issue doesn't seem to occur for me on a build from the release-1.5 branch. 1.5 is going to be out really soon. Still trying to understand what exactly fixed it.\n\nFYI the problem seems to be that the the response to the mutation that creates the device and allocates the IP address, returns an empty result for that ip address relation. But the IP address does seem to get allocated properly.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-10T10:39:17.369000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1437391157435957309","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":25},{"type":0,"content":"Awesome thx","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T20:28:35.584000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436452296941899967","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":24},{"type":0,"content":"it's just a test data set so nothing sensitive. You should find the `add-ams1` branch which is what I've been testing with","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T20:09:30.066000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436447492291170416","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":23},{"type":0,"content":"here is a dump of the db https://github.com/dpeachey/infrahub/blob/main/neo4j.dump","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/dpeachey/infrahub/blob/main/neo4j.dump","title":"infrahub/neo4j.dump at main ¬∑ dpeachey/infrahub","description":"Contribute to dpeachey/infrahub development by creating an account on GitHub.","color":1975079,"provider":{"name":"GitHub"},"content_scan_version":2}],"timestamp":"2025-11-07T20:09:02.729000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436447377631477873","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":22},{"type":0,"content":"Or a backup?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T16:53:10.169000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436398083821797439","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":21},{"type":0,"content":"Do you have a way to generate some of the data that you are using before I can run the generator üôÇ","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T16:52:01.272000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436397794846838928","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":20},{"type":0,"content":"it's also the same result if the generator runs as part of a PC","mentions":[],"mention_roles":[],"attachments":[{"id":"1436308990006005790","filename":"Screenshot_2025-11-07_at_11.58.38.png","size":18814,"url":"https://cdn.discordapp.com/attachments/1435592236002705409/1436308990006005790/Screenshot_2025-11-07_at_11.58.38.png?ex=69340c7c&is=6932bafc&hm=19922f8c53ee0716706aa629ff6d60225b863e4378e622664a060e416cd40398&","proxy_url":"https://media.discordapp.net/attachments/1435592236002705409/1436308990006005790/Screenshot_2025-11-07_at_11.58.38.png?ex=69340c7c&is=6932bafc&hm=19922f8c53ee0716706aa629ff6d60225b863e4378e622664a060e416cd40398&","width":2326,"height":428,"content_type":"image/webp","original_content_type":"image/png","content_scan_version":2,"placeholder":"8/cNAYCHmJh/d6d3uK+u/ds=","placeholder_version":1,"title":"Screenshot 2025-11-07 at 11.58.38"}],"embeds":[],"timestamp":"2025-11-07T10:59:08.522000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436308989897084979","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":19},{"type":0,"content":"Here's the repo: https://github.com/dpeachey/infrahub\nspecifically you'll want to look here: https://github.com/dpeachey/infrahub/tree/main/src/schemas and here: https://github.com/dpeachey/infrahub/blob/main/src/generators/topology_generator.py","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/dpeachey/infrahub","title":"GitHub - dpeachey/infrahub","description":"Contribute to dpeachey/infrahub development by creating an account on GitHub.","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/f44f431ad0c4349cf7ff305192d6184fd3af9be397dc9612d3e0d5b6dc589993/dpeachey/infrahub","proxy_url":"https://images-ext-1.discordapp.net/external/qA2Vy3cCpU-qoW7rMxrSz95FD97Y22-uhONu_puKh3Y/https/opengraph.githubassets.com/f44f431ad0c4349cf7ff305192d6184fd3af9be397dc9612d3e0d5b6dc589993/dpeachey/infrahub","width":1200,"height":600,"description":"Contribute to dpeachey/infrahub development by creating an account on GitHub.","flags":0},"content_scan_version":2},{"type":"article","url":"https://github.com/dpeachey/infrahub/tree/main/src/schemas","title":"infrahub/src/schemas at main ¬∑ dpeachey/infrahub","description":"Contribute to dpeachey/infrahub development by creating an account on GitHub.","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/f44f431ad0c4349cf7ff305192d6184fd3af9be397dc9612d3e0d5b6dc589993/dpeachey/infrahub","proxy_url":"https://images-ext-1.discordapp.net/external/qA2Vy3cCpU-qoW7rMxrSz95FD97Y22-uhONu_puKh3Y/https/opengraph.githubassets.com/f44f431ad0c4349cf7ff305192d6184fd3af9be397dc9612d3e0d5b6dc589993/dpeachey/infrahub","width":1200,"height":600,"description":"Contribute to dpeachey/infrahub development by creating an account on GitHub.","flags":0},"content_scan_version":2},{"type":"article","url":"https://github.com/dpeachey/infrahub/blob/main/src/generators/topology_generator.py","title":"infrahub/src/generators/topology_generator.py at main ¬∑ dpeachey/i...","description":"Contribute to dpeachey/infrahub development by creating an account on GitHub.","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/f44f431ad0c4349cf7ff305192d6184fd3af9be397dc9612d3e0d5b6dc589993/dpeachey/infrahub","proxy_url":"https://images-ext-1.discordapp.net/external/qA2Vy3cCpU-qoW7rMxrSz95FD97Y22-uhONu_puKh3Y/https/opengraph.githubassets.com/f44f431ad0c4349cf7ff305192d6184fd3af9be397dc9612d3e0d5b6dc589993/dpeachey/infrahub","width":1200,"height":600,"description":"Contribute to dpeachey/infrahub development by creating an account on GitHub.","flags":0},"content_scan_version":2}],"timestamp":"2025-11-07T10:47:06.607000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436305961965846582","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":18},{"type":0,"content":"Let me see if I can push my changes to a public repo.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T10:39:50.063000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436304130967736411","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":17},{"type":0,"content":"interestingly the behaviour is not the same each time I run it. So the first time I run it with:\n```\ninfrahubctl generator --branch add-ams1 topology_generator topology=ams1-topology\n```\nI do not see the IpamIPAddress query after the InfraDeviceUpsert mutation. On the second run I do see the IpamIPAddress query, but only once and it has only added one device. In total I expect 6 devices to be added (4 x leaf and 2 x spine).\n\nIt turns out that if I run it 6 times, all the devices are added (but I still get the error at the end). On the 7th run I don't get an error anymore.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T10:38:41.909000+00:00","edited_timestamp":"2025-11-07T10:39:23.994000+00:00","flags":0,"components":[],"id":"1436303845109141556","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":16},{"type":0,"content":"I'm unable to reproduce this on 1.4.9\nIs there a way you can share all of your code / schemas that you are using?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T09:09:53.867000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436281497681264682","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":15},{"type":0,"content":"After the mutation query, do you see this query similar to this one?\n```\nQUERY:\n\nquery {\n    IpamIPAddress(ids: [\"1875ac3c-4edd-59c3-d4d7-1065fd802137\"], offset: 0, limit: 50) {\n        count\n        edges {\n            node {\n                id\n                hfid\n                display_label\n                __typename\n                address {\n                    value\n                }\n                description {\n                    value\n                }\n                interface {\n                    node {\n                        id\n                        hfid\n                        display_label\n                        __typename\n                    }\n                }\n                ip_namespace {\n                    node {\n                        id\n                        hfid\n                        display_label\n                        __typename\n                    }\n                }\n                ip_prefix {\n                    node {\n                        id\n                        hfid\n                        display_label\n                        __typename\n                    }\n                }\n            }\n        }\n    }\n}\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T08:45:42.874000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436275411775393943","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":14},{"type":0,"content":"1.4.9","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T08:19:00.484000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436268690864734230","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":13},{"type":0,"content":"Which version of Infrahub and SDK are you using here?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-07T08:16:44.958000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1436268122427490404","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":12},{"type":0,"content":"note that I also create the ip pool as part of the generator, not sure if that is related:\n```\n        mgmt_prefix_pool = await self.client.get(kind=\"CoreIPPrefixPool\", name__value=\"mgmt-prefixes\")\n        mgmt_prefix = await self.client.allocate_next_ip_prefix(\n            resource_pool=mgmt_prefix_pool,\n            prefix_length=24,\n            identifier=site.name.value,\n            data={\"description\": f\"MGMT {site.name.value}\"},\n        )\n        mgmt_pool = await self.client.create(\n            kind=\"CoreIPAddressPool\",\n            name=f\"mgmt-ip-pool-{site.name.value.lower()}\",\n            default_address_type=\"IpamIPAddress\",\n            default_prefix_size=32,\n            resources=[mgmt_prefix],\n            is_pool=True,\n            ip_namespace={\"id\": \"default\"},\n            description=f\"MGMT {site.name.value}\",\n        )\n        await mgmt_pool.save(allow_upsert=True)\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:52:21.099000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435612704298631168","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":11},{"type":0,"content":"","mentions":[],"mention_roles":[],"attachments":[{"id":"1435612440866848768","filename":"message.txt","size":4259,"url":"https://cdn.discordapp.com/attachments/1435592236002705409/1435612440866848768/message.txt?ex=69337e06&is=69322c86&hm=e2e87356988aad5b36411831a40e68f69c4966e297ed619ed1e08f5af067bdfb&","proxy_url":"https://media.discordapp.net/attachments/1435592236002705409/1435612440866848768/message.txt?ex=69337e06&is=69322c86&hm=e2e87356988aad5b36411831a40e68f69c4966e297ed619ed1e08f5af067bdfb&","content_type":"text/plain; charset=utf-8","original_content_type":"text/plain","content_scan_version":2}],"embeds":[],"timestamp":"2025-11-05T12:51:18.372000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435612441202659519","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":10},{"type":0,"content":"Can you copy/paste the schema of InfraDevice ?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:50:08.843000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435612149576765511","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":9},{"type":0,"content":"ah nevermind, I think I'm wrong about that","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:48:47.385000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435611807917146174","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":8},{"type":0,"content":"","mentions":[],"mention_roles":[],"attachments":[{"id":"1435611546779910144","filename":"Screenshot_2025-11-05_at_13.47.25.png","size":28994,"url":"https://cdn.discordapp.com/attachments/1435592236002705409/1435611546779910144/Screenshot_2025-11-05_at_13.47.25.png?ex=69337d31&is=69322bb1&hm=9fbc4a10b55234348a387e7dc6fd730b6c8b44dd67ae326030c535fc64b2a671&","proxy_url":"https://media.discordapp.net/attachments/1435592236002705409/1435611546779910144/Screenshot_2025-11-05_at_13.47.25.png?ex=69337d31&is=69322bb1&hm=9fbc4a10b55234348a387e7dc6fd730b6c8b44dd67ae326030c535fc64b2a671&","width":1048,"height":1046,"content_type":"image/webp","original_content_type":"image/png","content_scan_version":2,"placeholder":"/fcBB4CAiKhjmYh4hopVeXZ5CPXXlm8K","placeholder_version":1,"title":"Screenshot 2025-11-05 at 13.47.25"}],"embeds":[],"timestamp":"2025-11-05T12:47:45.212000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435611547144556716","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":7},{"type":0,"content":"something related to the IP pool for the primary address possibly, because I see that the device has an IP assigned and I can see the IP under IP addresses in the IPAM, but in the resource manager I do not see it allocated","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:47:13.643000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435611414734573659","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"```\nURL: http://localhost:8000/graphql/add-ams1\nQUERY:\n\nmutation {\n    InfraDeviceUpsert(\n        data: {\n            config_type: {\n                value: \"yaml\"\n            }\n            name: {\n                value: \"leaf1-ams1\"\n            }\n            primary_address: {\n                from_pool: {\n                    id: \"1875179d-f812-a24a-2f98-c51bc7e97b4f\"\n                }\n            }\n            site: {\n                id: \"1875177d-c496-2e67-2f93-c51fe3fc4aca\"\n            }\n            topology: {\n                id: \"18751783-fa92-09c2-2f93-c51166212544\"\n            }\n            profiles: [\n                {\n                    id: \"1874dfae-c5cb-eca5-2f93-c51f2eadabda\"\n                },\n            ]\n            model: {\n                id: \"18748a63-e7d0-f2db-2f94-c5188afb6107\"\n            }\n        }\n    ){\n        ok\n        object {\n            id\n            primary_address {\n                node {\n                    id\n                    display_label\n                    __typename\n                }\n            }\n        }\n    }\n}\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:42:55.585000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435610332361134131","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":5},{"type":0,"content":"Can you set the environment variable `INFRAHUB_ECHO_GRAPHQL_QUERIES` to true and re-execute the generator. Then post the last GraphQL mutation it is sending please.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:40:42.451000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435609773956399165","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"even if I remove those though I still have the same issue","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:37:51.768000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435609058060013629","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"yes","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:33:29.242000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435607956946292766","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"Is `element.device_model` and `element.topology` a relationship (cardinality one) of element?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T12:15:56.278000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435603540495302736","channel_id":"1435592236002705409","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"Here is the snippet of code I use to generate the devices:\n\n```\n        for element in elements:\n            role = element.device_role.value\n            profiles = await self.client.filters(kind=\"ProfileInfraDevice\", role__value=role)\n\n            for x in range(element.quantity.value):\n                device_name = f\"{role}{x + 1}-{site.name.value.lower()}\"\n                device = await self.client.create(\n                    kind=\"InfraDevice\",\n                    name=device_name,\n                    profiles=profiles,\n                    config_type=element.config_type.value,\n                    primary_address=mgmt_pool,\n                    site=site,\n                    model=element.device_model,\n                    topology=element.topology,\n                )\n                await device.save(allow_upsert=True)\n```\n\nOne device actually gets created but not the rest.\n\nThanks,\n\nDan","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T11:31:05.459000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435592254382407691","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"Hi team,\n\nI'm playing around with using a generator to create devices but I'm hitting an issue I can't figure out. I get the following exception:\n\n```\nError: Unable to fetch the peer, id and/or typename are not defined\nTraceback (most recent call last):\n  File \"/Users/danpe/dev/infrahub/.venv/lib/python3.12/site-packages/infrahub_sdk/ctl/utils.py\", line 91, in async_wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danpe/dev/infrahub/.venv/lib/python3.12/site-packages/infrahub_sdk/ctl/cli_commands.py\", line 115, in generator\n    await run_generator(\n  File \"/Users/danpe/dev/infrahub/.venv/lib/python3.12/site-packages/infrahub_sdk/ctl/generator.py\", line 71, in run\n    await generator.run(identifier=generator_config.name, data=data)\n  File \"/Users/danpe/dev/infrahub/.venv/lib/python3.12/site-packages/infrahub_sdk/generator.py\", line 87, in run\n    await self.generate(data=unpacked)\n  File \"/Users/danpe/dev/infrahub/src/generators/topology_generator.py\", line 81, in generate\n    await device.save(allow_upsert=True)\n  File \"/Users/danpe/dev/infrahub/.venv/lib/python3.12/site-packages/infrahub_sdk/node/node.py\", line 605, in save\n    await self.create(allow_upsert=allow_upsert, timeout=timeout, request_context=request_context)\n  File \"/Users/danpe/dev/infrahub/.venv/lib/python3.12/site-packages/infrahub_sdk/node/node.py\", line 864, in create\n    await self._process_mutation_result(mutation_name=mutation_name, response=response, timeout=timeout)\n  File \"/Users/danpe/dev/infrahub/.venv/lib/python3.12/site-packages/infrahub_sdk/node/node.py\", line 833, in _process_mutation_result\n    await related_node.fetch(timeout=timeout)\n  File \"/Users/danpe/dev/infrahub/.venv/lib/python3.12/site-packages/infrahub_sdk/node/related_node.py\", line 206, in fetch\n    raise Error(\"Unable to fetch the peer, id and/or typename are not defined\")\ninfrahub_sdk.exceptions.Error: Unable to fetch the peer, id and/or typename are not defined\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T11:31:01.077000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435592236002705409","channel_id":"1435592236002705409","author":{"id":"918504524610695168","username":"dpeach44","avatar":"91d80b360d48938482b8a7e23147d057","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"dpeach","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]