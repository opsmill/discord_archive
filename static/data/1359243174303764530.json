[{"thread":{"id":"1359243174303764530","type":11,"last_message_id":"1359536315040792777","flags":0,"guild_id":"1212332642801025064","name":"Custom Infrahub Docker Image Error","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"1352654639522123826","thread_metadata":{"archived":true,"archive_timestamp":"2025-05-09T14:34:09.268000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-04-08T19:07:06.271000+00:00"},"message_count":3,"member_count":3,"total_message_sent":3,"applied_tags":["1301915235380363266"]},"messages":[{"type":0,"content":"I was able to get this all added in the docker-compose.override.yml file (no custom image built), so the task-workers have the proxy configurations and also custom CA certificates:\n\n```services:\n  task-worker:\n    user: root\n    environment:\n      - http_proxy=http://10.1.2.3:8080\n      - https_proxy=http://10.1.2.3:8080\n      - HTTP_PROXY=http://10.1.2.3:8080\n      - HTTPS_PROXY=http://10.1.2.3:8080\n      - no_proxy=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,localhost,127.0.0.1,infrahub-server,database,message-queue,cache,task-manager\n      - NO_PROXY=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,localhost,127.0.0.1,infrahub-server,database,message-queue,cache,task-manager\n    volumes:\n      - /opt/infrahub/custom-certs.crt:/usr/local/share/ca-certificates/custom-certs.crt\n    command: >\n      sh -c \"\n        update-ca-certificates &&\n        git config --global http.proxy http://10.1.2.3:8080 &&\n        prefect worker start --type infrahubentasync --pool infrahub-worker --with-healthcheck\"\n```\nDo you see any issues with this, or good to go?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T14:31:56.469000+00:00","edited_timestamp":"2025-04-09T17:23:17.550000+00:00","flags":0,"components":[],"id":"1359536315040792777","channel_id":"1359243174303764530","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"Understood, thank you.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T14:11:15.103000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359531108374679703","channel_id":"1359243174303764530","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"`infrahubentasync` is for the Infrahub Enterprise\nso either you need to use the base image to use Infrahub Enterprise if you want to build a custom image of the enterprise version\nor you need to update your docker compose file to use `infrahubasync`","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-04-09T04:32:42.589000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1359385513538224340","channel_id":"1359243174303764530","author":{"id":"695690467056025690","username":"dgarros","avatar":"67171294847dca2ce3ac938f5bca0443","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Damien","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"reactions":[{"emoji":{"id":null,"name":"üëç"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"https://docs.infrahub.app/guides/repository#installing-custom-ca-certificates\nFollowing the instructions in the above guide, it creates the Docker image (custom/infrahub:latest). I created a docker-compose.override.yml and added the extra config per the guide, and now getting the following error logs:\n\nsudo docker logs infrahub-task-worker-1\n2025-04-08T19:04:53.277891Z [debug    ] Popen(['git', 'version'], cwd=/source, stdin=None, shell=False, universal_newlines=False) [git.cmd]\n2025-04-08T19:04:53.280369Z [debug    ] Popen(['git', 'version'], cwd=/source, stdin=None, shell=False, universal_newlines=False) [git.cmd]\n2025-04-08T19:04:56.103712Z [debug    ] connect_tcp.started host='task-manager' port=4200 local_address=None timeout=60.0 socket_options=None [httpcore.connection]\n2025-04-08T19:04:56.105650Z [debug    ] connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x743adbd30f80> [httpcore.connection]\n2025-04-08T19:04:56.106074Z [debug    ] send_request_headers.started request=<Request [b'GET']> [httpcore.http11]\n2025-04-08T19:04:56.106567Z [debug    ] send_request_headers.complete  [httpcore.http11]\n2025-04-08T19:04:56.106682Z [debug    ] send_request_body.started request=<Request [b'GET']> [httpcore.http11]\n2025-04-08T19:04:56.106854Z [debug    ] send_request_body.complete     [httpcore.http11]\n2025-04-08T19:04:56.106949Z [debug    ] receive_response_headers.started request=<Request [b'GET']> [httpcore.http11]\n<redacted for brevity>\n**Could not find a package for worker type 'infrahubentasync'.\nUnable to start worker. Please ensure you have the necessary dependencies \ninstalled to run your desired worker type.**","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://docs.infrahub.app/guides/repository","title":"Adding external repositories | Infrahub Documentation","description":"Infrahub supports two different types of connections to external Git repositories:","content_scan_version":2}],"timestamp":"2025-04-08T19:07:06.271000+00:00","edited_timestamp":"2025-04-08T19:08:25.150000+00:00","flags":0,"components":[],"id":"1359243174303764530","channel_id":"1359243174303764530","author":{"id":"1352654639522123826","username":"thomas_72011","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Thomas","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]