[{"thread":{"id":"1349046365581480007","type":11,"last_message_id":"1349115007023054868","flags":0,"guild_id":"1212332642801025064","name":"Store artifacts on my own Minio Bucket","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"1303804080413474867","thread_metadata":{"archived":true,"archive_timestamp":"2025-04-10T20:23:59.031000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-03-11T15:48:37.624000+00:00"},"message_count":8,"member_count":4,"total_message_sent":8,"applied_tags":["1301915943663960064"]},"messages":[{"type":0,"content":"Hello, for your first question: yes you can use minio with Infrahub; there will be a deployment example using minio in our official docs soon\n\nabout the error: it would help to see the Helm values you are using to deploy, it's probably that you (mistakenly) disabled the neo4j chart... according to the error log, as Wim stated, its probably the neo4j database that is not properly running","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-03-11T20:21:23.019000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349115007023054868","channel_id":"1349046365581480007","author":{"id":"1220422159676084304","username":"fatih_10382_62805","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"fatih","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":7},{"type":0,"content":"That is weird. Do you have the same behavior locally when you set the environment variables?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-03-11T16:46:26.637000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349060915676315731","channel_id":"1349046365581480007","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"i can deploy in K8s, when i deploy it with the default env variables (Artifacts stored local) it works. I use the Same env variables without de AWS and Storage Variables.\n\nenv:\n      INFRAHUB_ALLOW_ANONYMOUS_ACCESS: \"true\"\n      INFRAHUB_CACHE_PORT: 6379\n      INFRAHUB_DB_TYPE: neo4j\n      INFRAHUB_LOG_LEVEL: INFO\n      INFRAHUB_PRODUCTION: \"false\"\n      INFRAHUB_INITIAL_ADMIN_TOKEN: 06438eb2-8019-4776-878c-0941b1f1d1ec\n      INFRAHUB_SECURITY_SECRET_KEY: 327f747f-efac-42be-9e73-999f08f86b92\n      INFRAHUB_GIT_REPOSITORIES_DIRECTORY: \"/opt/infrahub/git\"\n      INFRAHUB_WORKFLOW_ADDRESS: prefect-server\n      INFRAHUB_WORKFLOW_PORT: 4200\n      PREFECT_API_URL: \"http://prefect-server:4200/api\"\n    # -- Image pull policy for the API server\n    imagePullPolicy: Always\n    # -- Image registry to use for the API server\n    imageRegistry: registry.opsmill.io","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-03-11T16:26:17.507000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349055844217524327","channel_id":"1349046365581480007","author":{"id":"1303804080413474867","username":"raemsli_58909","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"raemsli","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":5},{"type":0,"content":"Ok, so when you deploy locally using docker-compose it works? But when you deploy somewhere else it doesn't? I assume the somewhere else is k8s?\n\nThe AWS env variables should not affect the neo4j (db) container at all.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-03-11T16:22:57.271000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349055004367130655","channel_id":"1349046365581480007","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"the infrahub-postegresql container is running without an error, the db container didnt even start to deploy (There are no logs and is on pending)\n\nAnd when i delete the AWS Env Variables and set it up to be local, it works.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-03-11T16:16:31.177000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349053384971386935","channel_id":"1349046365581480007","author":{"id":"1303804080413474867","username":"raemsli_58909","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"raemsli","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"I don't think the reason the server crashes, at this stage, is related to the object store you are using. It is failing to connect to the db container.\n\n```\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/neo4j/_async_compat/network/_bolt_socket.py\", line 388, in connect\n    s = await cls._connect_secure(\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/neo4j/_async_compat/network/_bolt_socket.py\", line 266, in _connect_secure\n    raise ServiceUnavailable(\nneo4j.exceptions.ServiceUnavailable: Failed to establish connection to ResolvedIPv4Address(('10.152.183.140', 7687)) (reason [Errno 1] Operation not permitted)\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-03-11T16:11:54.279000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349052223577001984","channel_id":"1349046365581480007","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"Hii Wim\n\nThanks for the Reply, here are the logs.","mentions":[],"mention_roles":[],"attachments":[{"id":"1349051297709555783","filename":"logs_infrahubserver.txt","size":10832,"url":"https://cdn.discordapp.com/attachments/1349046365581480007/1349051297709555783/logs_infrahubserver.txt?ex=6933ac2d&is=69325aad&hm=8e98866ef14611d924d73c4c2f749d75c3580c7b64c6c4cd0b4a933371567013&","proxy_url":"https://media.discordapp.net/attachments/1349046365581480007/1349051297709555783/logs_infrahubserver.txt?ex=6933ac2d&is=69325aad&hm=8e98866ef14611d924d73c4c2f749d75c3580c7b64c6c4cd0b4a933371567013&","content_type":"text/plain; charset=utf-8","content_scan_version":2}],"embeds":[],"timestamp":"2025-03-11T16:08:13.623000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349051298078523403","channel_id":"1349046365581480007","author":{"id":"1303804080413474867","username":"raemsli_58909","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"raemsli","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"Hey, any object storage that offers an S3 compatible API should \"in theory\" work.  Which seems to be the case for MinIO.\n\nCan you share the logs of the `infrahub-server` container?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-03-11T15:58:11.600000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349048773011181629","channel_id":"1349046365581480007","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"Hello everyone,\n\nFor our Bachelor Thesis by Urs Baumann, I would like to store the artifacts in an S3 bucket. Is there a way to use MinIO (or perhaps another tool) instead of AWS?\n\nHere is the configuration for my Infrahub server:\n\nenv:\n      INFRAHUB_ALLOW_ANONYMOUS_ACCESS: \"true\"\n      INFRAHUB_CACHE_PORT: 6379\n      INFRAHUB_DB_TYPE: neo4j\n      INFRAHUB_LOG_LEVEL: INFO\n      INFRAHUB_PRODUCTION: \"false\"\n      INFRAHUB_INITIAL_ADMIN_TOKEN: 06438eb2-8019-4776-878c-0941b1f1d1ec\n      INFRAHUB_SECURITY_SECRET_KEY: 327f747f-efac-42be-9e73-999f08f86b92\n      INFRAHUB_GIT_REPOSITORIES_DIRECTORY: \"/opt/infrahub/git\"\n      INFRAHUB_WORKFLOW_ADDRESS: prefect-server\n      INFRAHUB_WORKFLOW_PORT: 4200\n      PREFECT_API_URL: \"http://prefect-server:4200/api\"\n      INFRAHUB_STORAGE_DRIVER: s3\n      AWS_ACCESS_KEY_ID: ZmMgCCqn1zOLoNGEpPE9\n      AWS_SECRET_ACCESS_KEY: ersmEL0X7P1uTRDr2E6KYg6RhE9mX9e0tgnwn57R\n      INFRAHUB_STORAGE_BUCKET_NAME: infrahubbucket\n      INFRAHUB_STORAGE_ENDPOINT_URL: https://192.168.145.130:9000 # -- IP:Port to the API of the MinIO Bucket.\n\n\nUnfortunately, my infrahub-server crashes during the Application startup (uvicorn.error).\n\nThanks you for your help!","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-03-11T15:48:37.624000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1349046365581480007","channel_id":"1349046365581480007","author":{"id":"1303804080413474867","username":"raemsli_58909","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"raemsli","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]