[{"thread":{"id":"1435287982742437969","type":11,"last_message_id":"1435935592868348059","flags":0,"guild_id":"1212332642801025064","name":"Debugging batch.execute (SDK)","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"867799355921268767","thread_metadata":{"archived":false,"archive_timestamp":"2025-11-04T15:22:01.447000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-11-04T15:22:01.447000+00:00"},"message_count":22,"member_count":4,"total_message_sent":23,"applied_tags":["1322475882421555200","1304062537364410420"]},"messages":[{"type":0,"content":"https://github.com/opsmill/infrahub-sdk-python/pull/601\nI think that should fix the issue... not sure what we drank when we merged the PRs... ðŸ˜…","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/opsmill/infrahub-sdk-python/pull/601","title":"fix(client): hangs when using batches with parallel or other batch ...","description":"Summary by CodeRabbit\n\nRefactor\n\nSimplified concurrent execution control in batch processing with streamlined parameters.\nUnified async and sync batch construction mechanisms for improved consisten...","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/b984a0a3e0af67355ca981f38ff0730afc1b40a943511bb14f16b18f770a8faa/opsmill/infrahub-sdk-python/pull/601","proxy_url":"https://images-ext-1.discordapp.net/external/Ps7LB80dOtg06l1Kj0KVIE5N5nYtGSumOi93GabR4U4/https/opengraph.githubassets.com/b984a0a3e0af67355ca981f38ff0730afc1b40a943511bb14f16b18f770a8faa/opsmill/infrahub-sdk-python/pull/601","width":1200,"height":600,"description":"Summary by CodeRabbit\n\nRefactor\n\nSimplified concurrent execution control in batch processing with streamlined parameters.\nUnified async and sync batch construction mechanisms for improved consisten...","flags":0},"content_scan_version":2}],"timestamp":"2025-11-06T10:15:23.733000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435935592868348059","channel_id":"1435287982742437969","author":{"id":"1220422159676084304","username":"fatih_10382_62805","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"fatih","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":22,"reactions":[{"emoji":{"id":null,"name":"ðŸš€"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"I think this is related to the following changes:\nhttps://github.com/opsmill/infrahub-sdk-python/pull/483/files\nwhich was a fix for\nhttps://github.com/opsmill/infrahub-sdk-python/pull/476\n\ntl;dr we had to switch to using a new `InfrahubBatch` object instead of using `create_batch()` but that was a workaround... we didn't think of end users that would still use `create_batch()` so I believe we have to make `create_batch` work again for async clients...","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/opsmill/infrahub-sdk-python/pull/483/files","title":"Create batch directly instead of using create_batch while fetching ...","description":"Without this change the latest release (1.3.5) wouldn&amp;#39;t work in Infrahub\n\nSummary by CodeRabbit\n\nDocumentation\n\nUpdated the changelog to note that a new batch is created when fetching relat...","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://avatars.githubusercontent.com/u/304126?s=400&v=4","proxy_url":"https://images-ext-1.discordapp.net/external/WDNYJaJpHuKyWe5H3VoUmk7zBLajX0ieOnVhdbNGYSU/%3Fs%3D400%26v%3D4/https/avatars.githubusercontent.com/u/304126","width":400,"height":400,"content_type":"image/jpeg","placeholder":"J0kGFwbQeHaddYdyiJiYZ3h2uQOWS2AL","placeholder_version":1,"description":"Without this change the latest release (1.3.5) wouldn&#39;t work in Infrahub\n\nSummary by CodeRabbit\n\nDocumentation\n\nUpdated the changelog to note that a new batch is created when fetching relations...","flags":0},"content_scan_version":2},{"type":"article","url":"https://github.com/opsmill/infrahub-sdk-python/pull/476","title":"fix: improve cardinality many relationship fetch by fatih-acar Â· P...","description":"Fixes #475\nUsing plain filters() call with a list of ids to fetch is better than sequentially fetching each id.\nUsing parallel=False we get:\nreal    0m17.552s\nuser    0m2.329s\nsys     0m0.061s\n\nWit...","color":1975079,"provider":{"name":"GitHub"},"content_scan_version":2}],"timestamp":"2025-11-06T09:59:51.500000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435931682799747092","channel_id":"1435287982742437969","author":{"id":"1220422159676084304","username":"fatih_10382_62805","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"fatih","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":21},{"type":0,"content":"Well that was fast. 1.13.3 is the last version that worked. When I update to 1.13.4 it stops working","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T21:10:46.061000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435738134800371914","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":20},{"type":0,"content":"I still have the old setup running. It worked with the SDK version 1.13.3 with Python 3.12. I will try to find the version where it stops working\n\n```\nurs@DESKTOP-BM35OBL:~/projects/demo_infrahub_pydantify$ infrahubctl info\n Address:            http://10.8.34.1:8000 \n Connection Status:  âœ…                    \n Python Version:     3.12.7                \n SDK Version:        1.13.3                \n Infrahub Version:   1.3.0                 \n User:               Admin \n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T21:04:21.900000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435736523512483903","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":19},{"type":0,"content":"Interesting, the problem seems to occur only with the async SDK client ðŸ¤”","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T19:51:48.894000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435718265681875036","channel_id":"1435287982742437969","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":17},{"type":0,"content":"Oh, that works very nicely. It only requires three queries to retrieve all the data.\nI should read the documentation more often xD","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T11:21:26.455000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435589825863618570","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":16},{"type":0,"content":"I will definitely give it a try. Thanks a lot!","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T11:07:12.975000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435586246108909569","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":15},{"type":0,"content":"The alternative approach I mentioned uses a batch to parallelise the requests, the benefit is that you donâ€™t have to manage the batch yourself.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T11:03:07.849000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435585217975947376","channel_id":"1435287982742437969","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":14},{"type":0,"content":"I do it without a batch now and it works fine. Thanks for the help!","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T10:48:15.034000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435581473238548574","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":13},{"type":0,"content":"I fetch the info because of my nested schema. \nA Device has an Interface, and the interface has a remote interface, which is again part of a Device, and I need all the interface names and the remote device name. With the `convert_query_response: True` option I only get the infos for 2 levels and I fetch the rest with the code snippet.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T10:47:10.772000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435581203704184895","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":12},{"type":0,"content":"I was able to reproduce this. Should be an issue in the SDK, that we'll have to look into.\n\nIt's not really clear why you want to do the fetch, as most of the interface data seems to be already queried in the GraphQL query.\n\nAn alternative approach, if you have to fetch additional data could be:\n\n```python\ninterface_ids = [\n  interface.id\n  for device in self.nodes\n  for interface in device.interfaces.peers\n]\nawait self.client.filters(\"NetworkInterface\", ids=interface_ids, parallel=True)\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-05T09:32:42.043000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435562460496269342","channel_id":"1435287982742437969","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":11,"reactions":[{"emoji":{"id":null,"name":"ðŸš€"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"```\n Python Version:     3.13.0                               \n SDK Version:        1.14.0                               \n Infrahub Version:   1.4.12 \n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T23:27:19.013000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435410110665986049","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":10},{"type":0,"content":"I hope it is kind of understandable what I mean xD","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T23:20:08.977000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435408306964267069","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":9},{"type":0,"content":"I assume the count queries are waiting for the detail query","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T23:19:00.181000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435408018413191235","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":8},{"type":0,"content":"With `INFRAHUB_MAX_CONCURRENT_EXECUTION=6` it works (I have 5 devices)","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T23:17:51.005000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435407728267759616","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":7},{"type":0,"content":"With `INFRAHUB_ECHO_GRAPHQL_QUERIES`, I see queries\n\nWithout a batch, I see the main query and then alternate between a NetworkInterface count query and a NetworkInterface details query until all data is processed.\n\nWith the default concurrent jobs I get the main query and 5 NetworkInterface count querry and it hangs.\n\nWith concurrent 1  I see just the first count querry","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T23:15:14.812000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435407073146966016","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"Can you set the `INFRAHUB_MAX_CONCURRENT_EXECUTION` environment variable to 1 and then try executing the transform again?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T21:50:44.908000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435385808428208271","channel_id":"1435287982742437969","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":5},{"type":0,"content":"Could you run with `INFRAHUB_ECHO_GRAPHQL_QUERIES` and see if it provides a query?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T21:24:19.955000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435379160653500442","channel_id":"1435287982742437969","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"I did not change any SDK settings\nOn version 1.4.12 I should see the API logs on `infrahub-server` right? I did not see anything with INFO level but will update to DEBUG and test again.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T21:23:42.043000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435379001639305318","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"Hmm. Did you set the max_concurrent_execution SDK configuration option to a specific value?\nIs there anything showing up in the logs of the API server, when you try to execute the transform using `infrahubctl`?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T21:00:22.946000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435373133401034940","channel_id":"1435287982742437969","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"No change when I add the argument. It is still hanging.\nThis would be the transform code: https://gitlab.ost.ch/netaut/exercise-sources/infrahub_project/-/blob/main/infrahub/transforms/containerlab.py?ref_type=heads","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T20:23:49.739000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435363934424010774","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"ðŸ‘‹ can you try adding the following argument to  the `create_batch()` method `return_exceptions=True`. \n\nhttps://docs.infrahub.app/python-sdk/guides/batch#handling-exceptions-in-tasks","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://docs.infrahub.app/python-sdk/guides/batch","title":"Executing queries in a batch | Infrahub Documentation","description":"The Python SDK client allows you to group the execution of multiple queries in a batch.","content_scan_version":2}],"timestamp":"2025-11-04T17:34:42.254000+00:00","edited_timestamp":"2025-11-04T17:37:31.927000+00:00","flags":0,"components":[],"id":"1435321372787216535","channel_id":"1435287982742437969","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"Is there an easy way to debug `batch.execute`?\nContext: I use a \"python_transform\" with the option `convert_query_response: True`. I used a batch execution to fetch all the nested objects.\nThe following code snippet worked on v1.4.3 and now I updated to v1.4.12 and it is hanging at the batch.execute.\n```\n    async def fetch(self):\n        batch = await self.client.create_batch()\n        for device in self.nodes:\n            batch.add(task=device.interfaces.fetch)\n            \n        # Asynchronous List Comprehensions\n        [_ async for _ in batch.execute()]\n```\n\nWhen I use the `--debug` option on `infrahubctl transform --debug TransformContainerlabTopology` I don't get any log output. I assume I am missing something here.\n\n\nHowever, the following snippet is working for now and I have a solution. I am just interested to know how I could debug the issue.\n\n```\n    async def fetch(self):\n        batch = await self.client.create_batch()\n        for device in self.nodes:\n            await device.interfaces.fetch()\n```\n\n\nPS: also this code is hanging:\n```\n        async for _ in batch.execute():\n            pass\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-11-04T15:22:01.447000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1435287982742437969","channel_id":"1435287982742437969","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]