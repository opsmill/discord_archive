[{"thread":{"id":"1324548896105431140","type":11,"last_message_id":"1326216328205438987","flags":0,"guild_id":"1212332642801025064","name":"Best practices for removing things from a schema","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"123965055434883073","thread_metadata":{"archived":true,"archive_timestamp":"2025-02-06T15:55:22.780000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-01-03T01:24:25.760000+00:00"},"message_count":26,"member_count":4,"total_message_sent":26,"applied_tags":["1301914864339648552"]},"messages":[{"type":0,"content":"Okay so it is a bug then. I thought I was doing something wrong or not doing things in the correct order.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-07T15:50:12.552000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1326216328205438987","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":25,"reactions":[{"emoji":{"id":null,"name":"üëç"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"So in this case, for now, I don't think there is a workaround.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-07T08:47:55.322000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1326110056160165920","channel_id":"1324548896105431140","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":24},{"type":0,"content":"Indeed, looking at it a bit more you seem to be unable to remove a generic from the schema\nI have opened this issue on it: https://github.com/opsmill/infrahub/issues/5388\n#5384 is probably just the same issue.\n\nNot sure why I didn't think about it yesterday!","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/opsmill/infrahub/issues/5388","title":"bug: unable to remove a generic from the schema ¬∑ Issue #5388 ¬∑ ops...","description":"Component API Server / GraphQL Infrahub version 1.1.1 Current Behavior You get a HTTP 404 response when you try to delete a generic from the schema Expected Behavior The generic is removed from the...","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/7532a0118e8d0c7456a08f5e63d6a846851f9bb1b31900158da1867767bb525a/opsmill/infrahub/issues/5388","proxy_url":"https://images-ext-1.discordapp.net/external/IDWTbwKosf3nD_SXEkkpgCEMlUKaiWFOgXMpV36NImo/https/opengraph.githubassets.com/7532a0118e8d0c7456a08f5e63d6a846851f9bb1b31900158da1867767bb525a/opsmill/infrahub/issues/5388","width":1200,"height":600,"content_type":"image/png","placeholder":"+vcFDIKGiZiJiHeYZn+Hb/GxDQ==","placeholder_version":1,"flags":0},"content_scan_version":1}],"timestamp":"2025-01-07T08:47:35.301000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1326109972186136626","channel_id":"1324548896105431140","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":23},{"type":0,"content":"I was able to remove the relationships from both Generics, but they are still showing the basic relationships in the GUI:\n\nBut I still can't remove either of the Generics. Get the same error trying to delete them individually or at the same time:\n\ninfrahubctl schema load --branch schema extensions/modules\nHTTP communication failure: Client error '404 Not Found' for url 'http://192.168.22.10:8000/api/schema/load?branch=schema'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 on POST to http://192.168.22.10:8000/api/schema/load?branch=schema","mentions":[],"mention_roles":[],"attachments":[{"id":"1325991319423946783","filename":"image.png","size":375551,"url":"https://cdn.discordapp.com/attachments/1324548896105431140/1325991319423946783/image.png?ex=69337f26&is=69322da6&hm=feab54e3062ce5aa0438eeea1e5ba9b594b06e1200e9c3a46a929485926cba43&","proxy_url":"https://media.discordapp.net/attachments/1324548896105431140/1325991319423946783/image.png?ex=69337f26&is=69322da6&hm=feab54e3062ce5aa0438eeea1e5ba9b594b06e1200e9c3a46a929485926cba43&","width":2776,"height":1346,"content_type":"image/png","content_scan_version":2,"placeholder":"PfgBA4Bzcgh8Vpdk4KUGuqk=","placeholder_version":1},{"id":"1325991319809691680","filename":"image.png","size":364259,"url":"https://cdn.discordapp.com/attachments/1324548896105431140/1325991319809691680/image.png?ex=69337f26&is=69322da6&hm=ca3699be11764e31a021ccb3e60496d82f4eaf16ea10ccaabc4f3ec4a497677d&","proxy_url":"https://media.discordapp.net/attachments/1324548896105431140/1325991319809691680/image.png?ex=69337f26&is=69322da6&hm=ca3699be11764e31a021ccb3e60496d82f4eaf16ea10ccaabc4f3ec4a497677d&","width":2736,"height":1306,"content_type":"image/png","content_scan_version":2,"placeholder":"/fcBA4BXcCZqd8hj8aQItdg=","placeholder_version":1}],"embeds":[],"timestamp":"2025-01-07T00:56:06.215000+00:00","edited_timestamp":null,"flags":4,"components":[],"id":"1325991319159701555","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":22},{"type":0,"content":"So I'm in a situation where I can't delete either of those generics right now. Seems that since upgrading to V1.1.1 I can now delete the schema branch though so that keeps me up and running without having to start over","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-07T00:19:12.870000+00:00","edited_timestamp":"2025-01-07T00:20:40.837000+00:00","flags":0,"components":[],"id":"1325982035717787749","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":21},{"type":0,"content":"The final combination is this file where I would expect it to remove \"GenericModuleType\" but I get this error:\n\ninfrahubctl schema load --branch schema extensions/modules\nUnable to load the schema:\n  'DeviceGenericModuleType' has been removed but is still referenced in 'DeviceGenericModule.module_type'; keep it or delete the relationship","mentions":[],"mention_roles":[],"attachments":[{"id":"1325981865714122824","filename":"modules.yml","size":3760,"url":"https://cdn.discordapp.com/attachments/1324548896105431140/1325981865714122824/modules.yml?ex=69337658&is=693224d8&hm=7521cba83d35e569ae09a96c70acac1a068da5bc3837fac6d30f237a29bb2eb8&","proxy_url":"https://media.discordapp.net/attachments/1324548896105431140/1325981865714122824/modules.yml?ex=69337658&is=693224d8&hm=7521cba83d35e569ae09a96c70acac1a068da5bc3837fac6d30f237a29bb2eb8&","content_type":"text/plain; charset=utf-8","content_scan_version":2}],"embeds":[],"timestamp":"2025-01-07T00:18:32.368000+00:00","edited_timestamp":"2025-01-07T00:22:38.020000+00:00","flags":0,"components":[],"id":"1325981865840218216","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":20},{"type":0,"content":"When I modify the file to this I would expect it to remove both generics, but I get this error:\n\ninfrahubctl schema load --branch schema extensions/modules\nUnable to load the schema:\n  'DeviceGenericModuleType' has been removed but is still referenced in 'DeviceGenericModule.module_type'; keep it or delete the relationship","mentions":[],"mention_roles":[],"attachments":[{"id":"1325981311722328114","filename":"modules.yml","size":3648,"url":"https://cdn.discordapp.com/attachments/1324548896105431140/1325981311722328114/modules.yml?ex=693375d4&is=69322454&hm=90d0ecd1f2922fe6a93fe2f0b514ec69bcf076ef059c939791cdbf89d0397b48&","proxy_url":"https://media.discordapp.net/attachments/1324548896105431140/1325981311722328114/modules.yml?ex=693375d4&is=69322454&hm=90d0ecd1f2922fe6a93fe2f0b514ec69bcf076ef059c939791cdbf89d0397b48&","content_type":"text/plain; charset=utf-8","content_scan_version":2}],"embeds":[],"timestamp":"2025-01-07T00:16:20.266000+00:00","edited_timestamp":"2025-01-07T00:22:49.246000+00:00","flags":0,"components":[],"id":"1325981311764009002","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":19},{"type":0,"content":"With this file I would expect it to remove \"GenericModule\" only, but I get this error:\n\ninfrahubctl schema load --branch schema extensions/modules\nHTTP communication failure: Client error '404 Not Found' for url 'http://192.168.22.10:8000/api/schema/load?branch=schema'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 on POST to http://192.168.22.10:8000/api/schema/load?branch=schema","mentions":[],"mention_roles":[],"attachments":[{"id":"1325980800348590120","filename":"modules.yml","size":3740,"url":"https://cdn.discordapp.com/attachments/1324548896105431140/1325980800348590120/modules.yml?ex=6933755a&is=693223da&hm=974db2f49bf1c87299b63dce9a7a0dd765be6ba22ccd2ad063ba7f0daffaa987&","proxy_url":"https://media.discordapp.net/attachments/1324548896105431140/1325980800348590120/modules.yml?ex=6933755a&is=693223da&hm=974db2f49bf1c87299b63dce9a7a0dd765be6ba22ccd2ad063ba7f0daffaa987&","content_type":"text/plain; charset=utf-8","content_scan_version":2}],"embeds":[],"timestamp":"2025-01-07T00:14:18.327000+00:00","edited_timestamp":"2025-01-07T00:22:59.761000+00:00","flags":4,"components":[],"id":"1325980800314769459","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":18},{"type":0,"content":"The extension relationship seems to remove just fine as long as it is the only thing being removed. The generics however I can't remove them.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-07T00:10:24.845000+00:00","edited_timestamp":"2025-01-07T00:24:18.246000+00:00","flags":0,"components":[],"id":"1325979821020414084","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":17},{"type":0,"content":"I have tried a bunch of different combinations of removing the extension relationship first then trying the individual generics either at the same time or individually and I can't seem to remove either of the generics no matter what I have tried. Do I have to remove the relationships on the generics first?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-07T00:09:21.779000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1325979556502310912","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":16},{"type":0,"content":"What is the work around for the bug you have linked above?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-06T23:14:41.752000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1325965799072206848","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":15},{"type":19,"content":"Correct.\nBut you have to remove relationships on other nodes that reference the generic/node as a peer  explicitly. Which can be done in a single operation.","mentions":[{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-06T22:30:50.717000+00:00","edited_timestamp":"2025-01-06T22:31:09.808000+00:00","flags":0,"components":[],"id":"1325954763711582230","channel_id":"1324548896105431140","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"message_reference":{"type":0,"channel_id":"1324548896105431140","message_id":"1325953376982143102","guild_id":"1212332642801025064"},"position":14,"referenced_message":{"type":0,"content":"So when you remove a node or generic the relationships attached to them are also removed? You don't have to remove them first?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-06T22:25:20.095000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1325953376982143102","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":12}},{"type":0,"content":"Another thing is, then branch in which you loaded the schema files should not become \"unstable\". \n\nI tried to follow the exact same steps as you were describing, but my branch kept on working properly. I can create/delete/update nodes and I can still delete the branch. Is this something you can reproduce?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-06T22:25:31.398000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1325953424390619256","channel_id":"1324548896105431140","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":13},{"type":0,"content":"So when you remove a node or generic the relationships attached to them are also removed? You don't have to remove them first?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-06T22:25:20.095000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1325953376982143102","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":12},{"type":0,"content":"You have to add `state: absent` to the schema file for the 2 generics and to the relationship defined in the extension. For completeness you cand find the modules file as attachment.\n\nUnfortunately there seems to be an issue when you simultaneously remove a relationship from an extension, that references a generic that you are also removing. \n\nhttps://github.com/opsmill/infrahub/issues/5384","mentions":[],"mention_roles":[],"attachments":[{"id":"1325952854736769145","filename":"modules.yml","size":3627,"url":"https://cdn.discordapp.com/attachments/1324548896105431140/1325952854736769145/modules.yml?ex=69340413&is=6932b293&hm=7da41914d12582871e3cd2d668e907a31c5a499bfd876db0afc6942de46933ae&","proxy_url":"https://media.discordapp.net/attachments/1324548896105431140/1325952854736769145/modules.yml?ex=69340413&is=6932b293&hm=7da41914d12582871e3cd2d668e907a31c5a499bfd876db0afc6942de46933ae&","content_type":"text/plain; charset=utf-8","content_scan_version":0}],"embeds":[{"type":"article","url":"https://github.com/opsmill/infrahub/issues/5384","title":"bug: unable to remove a relationship to a generic from a schema ext...","description":"Component API Server / GraphQL Infrahub version 1.1.1 Current Behavior When you try to delete a relationship from a schema extension, that references a generic that also gets removed during the sam...","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/5ddd1d04eef8000f4c4cb45327d23a8240fa2a9166ea2e62ed53aa88afd3d1d7/opsmill/infrahub/issues/5384","proxy_url":"https://images-ext-1.discordapp.net/external/FtLmCy13tYK1kTAZuhA3i4hI_n1hKPZoPaGtFjk0WF0/https/opengraph.githubassets.com/5ddd1d04eef8000f4c4cb45327d23a8240fa2a9166ea2e62ed53aa88afd3d1d7/opsmill/infrahub/issues/5384","width":1200,"height":600,"content_type":"image/png","placeholder":"+vcFDICWiZiJiHiZdn+Hb/HBDQ==","placeholder_version":1,"flags":0},"content_scan_version":1}],"timestamp":"2025-01-06T22:23:15.574000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1325952854703476779","channel_id":"1324548896105431140","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":11},{"type":0,"content":"My first attempt was just to remove the 2 generics in hopes it would remove everything including the relationships. That didn't work as you see the error above. My next few attempts were me trying to remove the 2 generics and every relationship in the original schema file.\n\nI guess what I hoped to get from this thread isn't so much how to fix my issue (I started over and everything is blown away now) but to better understand how I should have gone about removing the original schema file. I can then test that myself to make sure it works and I understand the process. So given the original schema file what is the correct way to remove the 2 Generics and everything associated with them from the system schema?","mentions":[],"mention_roles":[],"attachments":[{"id":"1325851884115722240","filename":"modules.yml","size":3567,"url":"https://cdn.discordapp.com/attachments/1324548896105431140/1325851884115722240/modules.yml?ex=6933a60a&is=6932548a&hm=e814575915a4359386216ef1e518c1ee8b10d91298ecef903a190c9d9dcf305c&","proxy_url":"https://media.discordapp.net/attachments/1324548896105431140/1325851884115722240/modules.yml?ex=6933a60a&is=6932548a&hm=e814575915a4359386216ef1e518c1ee8b10d91298ecef903a190c9d9dcf305c&","content_type":"text/plain; charset=utf-8","content_scan_version":0}],"embeds":[],"timestamp":"2025-01-06T15:42:02.389000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1325851884447203399","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":10},{"type":0,"content":"Without your version of the schema files, it is going to be hard. But just looking at the first error messages.\n\nYou removed DeviceGenericModuleType using state absent, but on DeviceGenericModule there is a relationship `module_type` that references `DeviceGenericModuleType` That relationship will also need to be removed with `state: absent`\n\nFor the other 2 we would really need to understand the changes you did to the schema files.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-06T08:21:31.482000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1325741025188122716","channel_id":"1324548896105431140","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":9},{"type":19,"content":"I tried a bunch of different options for deleting and nothing seemed to work and all I got were errors:\n\nUnable to load the schema:\n  'DeviceGenericModuleType' has been removed but is still referenced in 'DeviceGenericModule.module_type'; keep it or delete the relationship\n\nUnable to load the schema:\n  DeviceGenericModuleType.uniqueness_constraints: manufacturer is invalid on schema DeviceGenericModuleType\n\nUnable to load the schema:\n  DeviceGenericModule: Requested unique constraint not found within node. (`serial_number__value`)\n\n\n\nAfter all those errors and my trying to make it work I just started fresh and figured I would ask here so I can better understand how to use \"state: absent\"","mentions":[{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T20:31:52.410000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324837659885178891","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"message_reference":{"type":0,"channel_id":"1324548896105431140","message_id":"1324745721903059004","guild_id":"1212332642801025064"},"position":8,"referenced_message":{"type":0,"content":"Just the YAML file of the schema you're attempting to modify before and then with the changes in that file you're trying to use to remove.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T14:26:32.687000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324745721903059004","channel_id":"1324548896105431140","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":5}},{"type":0,"content":"I've run into this as well - there are some corners cases where it's easier/faster (at least while not in prod) to just `invoke demo.destroy; invoke demo.create; sleep 5; infrahubctl schema load...` than it is to try to wrangle my way through deleting references and relationships","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T16:08:58.079000+00:00","edited_timestamp":"2025-01-03T16:09:10.643000+00:00","flags":0,"components":[],"id":"1324771497545433221","channel_id":"1324548896105431140","author":{"id":"1268206427810435166","username":"scotho3","avatar":"90c6511092222bc6f42f2614fb0ebef7","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"scotho3","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":7},{"type":0,"content":"Those steps work as well and I will try and reproduce.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T14:26:56.872000+00:00","edited_timestamp":"2025-01-03T14:27:06.892000+00:00","flags":0,"components":[],"id":"1324745823342559354","channel_id":"1324548896105431140","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"Just the YAML file of the schema you're attempting to modify before and then with the changes in that file you're trying to use to remove.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T14:26:32.687000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324745721903059004","channel_id":"1324548896105431140","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":5},{"type":19,"content":"What is the best way to gather the schema pre/post \"absent\" for sharing?","mentions":[{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T08:55:32.330000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324662421528514560","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"message_reference":{"type":0,"channel_id":"1324548896105431140","message_id":"1324560397549703269","guild_id":"1212332642801025064"},"position":4,"referenced_message":{"type":0,"content":"Hi Themar. Do you mind providing your schema pre/post \"absent\"?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T02:10:07.918000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324560397549703269","channel_id":"1324548896105431140","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1}},{"type":0,"content":"I ended up starting over because the whole system ended up in an unstable state and I couldn't delete any of the branches or remove any of the nodes.\n\nIt seems something causes a problem when I add the module.yml schema file from the schema-library. To reproduce this I start with a clean curl install of infrahub. I make a branch called schema. I install the 4 base schema files to the schema branch. I then install the extensions/modules/modules.yml file to branch schema. Once that completes the schema branch becomes unstable and unusable. I tried to add \"state:absent\" to the 2 generics and 1 extension in modules.yml and hope that would remove those from the schema, but I just kept getting errors applying the schema file. I also couldn't delete the schema branch. Just kept saying there was an error deleting the branch. I finally just started clean and figured I would ask here for some guidance on removing things from the schema.\n\nInfrahub: v1.1.0\nPython SDK: v1.3.0","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T08:50:14.981000+00:00","edited_timestamp":"2025-01-03T09:30:49.087000+00:00","flags":0,"components":[],"id":"1324661090470068295","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"Also, what version of Infrahub?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T02:14:59.903000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324561622223814815","channel_id":"1324548896105431140","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"Hi Themar. Do you mind providing your schema pre/post \"absent\"?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T02:10:07.918000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324560397549703269","channel_id":"1324548896105431140","author":{"id":"370964598284746752","username":"foolproofalibi","avatar":"51c8acd4dcd60cb1cea707612872daf5","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Foolproofalibi","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"also wondering how to format the yaml file. Do we need to include all the extra information like labels, descriptions, kind, etc about an item before we can remove it?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T01:28:03.674000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324549810102997043","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"I found the documentation that says to set the item as \"state: absent\" but that doesn't seem to work if the node has relationships, uniqueness constraints, etc. It seems like you have to delete things in a specific order and I'm wondering what that order is or should be?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-01-03T01:24:25.760000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1324548896105431140","channel_id":"1324548896105431140","author":{"id":"123965055434883073","username":"themar4321","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Themar","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]