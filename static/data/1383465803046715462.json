[{"thread":{"id":"1383465803046715462","type":11,"last_message_id":"1383569611437375588","flags":0,"guild_id":"1212332642801025064","name":".infrahub.yml declarative approach","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"811281824768458793","thread_metadata":{"archived":true,"archive_timestamp":"2025-07-14T22:18:21.785000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-06-14T15:19:10.998000+00:00"},"message_count":3,"member_count":2,"total_message_sent":5,"applied_tags":["1301915943663960064","1305932861442097223"]},"messages":[{"type":0,"content":"Sorry, you are right, I missed them.\nYes, the artifact validators were run as part of a proposed change. \n\nWe can delete them.\n\nFirst we need to get all of them with the following GraphQL query, replace \"id\" with the id of the artifact definition (you can use another filter as well, for ex the defintion name)\n```graphql\nquery {\n  CoreArtifactValidator(definition__ids: [\"id\"]) {\n    edges {\n      node {\n        id\n      }\n    }\n  }\n}\n```\n\nthen we can delete each one of them with the following mutation\n```graphql\nmutation {\n  CoreArtifactValidatorDelete(data: {\n    id: \"<id>\"\n  }) {\n    ok \n  }\n}\n```\n\nOpening an issue on not updating the class name would be helpful yes, thank you!  I haven't been able to look into that one yet.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-14T22:11:40.847000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1383569611437375588","channel_id":"1383465803046715462","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"Hello <@1221732604806692884>, thank you for your answer.\nI had an issue with the mentioned order on step 2 - I was unable to delete the artifact definition due to artifact validators (not sure what those are and how to delete them) \nEnded up just wiping the db and starting anew, but I imagine that is not an option for production instaces.\nIn the meantime should i create an issue about python transform not updating the classname? I would consider it a bug as for example updating target on artifact definition works well.","mentions":[{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-14T22:03:41.072000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1383567599115304969","channel_id":"1383465803046715462","author":{"id":"811281824768458793","username":"matej3653","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Matej Lanca","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"Yes, it is a bit of a pain at the moment to delete resources imported from a repository.\n\nIf you need to remove a Python transform then this is the order that you have to follow:\n- delete artifacts generated from this transform (if any) and their graphql query groups\n- delete the artifact defintion\n- delete the transform\n- delete the query\n\nYou can set the `on_delete` option of a relationship to `cascade` on your schemas.\nUnfortunately there is a little bit more to this. There is even the question if this is desired behavior for everyone. I can imagine someone migth want to delete a repository, but not the artifacts that were generated using resources in that repository.\n\nWe are aware it is a problem and we'll definitely try to provide a better experience for this in the future.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-14T21:40:30.188000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1383561765324980245","channel_id":"1383465803046715462","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"Today I tried making the following changes to .infrahub.yml file:\n1. adding new python transform\n2. renaming the class name of said transform - the changes do not update the loaded object\n3. removing a query - the import object task tries to delete the query, but fails due to it being linked to CoreGraphQLQueryGroup\n4. adding new query - registered fine\n\nThe intention of .infrahub.yml file being declarative is nice, but might need a bit more tuning.\nI am trying to delete the loaded objects manualy in the UI in order to load them in again, but having trouble at that due to the mandatory relationships existing between the objects. If I try deleting the query it does not let me because it has mandatory relationship to transform which is linked to artifact definition which is linked to artifact validators(that are not in the UI)\nQ1 What is the correct order to manualy delete them in? Is it even possible?\nQ2 Is there a setting to set mandatory relationships to on delete cascade as it is natively for component relationships. Would be helpful to just be able to delete the repository object for it to delete all the imported objects from that repository.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-14T15:19:10.998000+00:00","edited_timestamp":"2025-06-14T15:31:14.718000+00:00","flags":0,"components":[],"id":"1383465803046715462","channel_id":"1383465803046715462","author":{"id":"811281824768458793","username":"matej3653","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Matej Lanca","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false}]}]