[{"thread":{"id":"1316345739613310986","type":11,"last_message_id":"1382319010137374821","flags":0,"guild_id":"1212332642801025064","name":"Python package in infrahub-task-worker","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"1300537046833692725","thread_metadata":{"archived":true,"archive_timestamp":"2025-07-11T11:29:25.566000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2024-12-11T10:08:00.845000+00:00"},"message_count":13,"member_count":4,"total_message_sent":13,"applied_tags":["1301915115469410304","1322475882421555200"]},"messages":[{"type":0,"content":"Yeah would not suit what we have atm. Plus its overly complex","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-11T11:22:14.262000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1382319010137374821","channel_id":"1316345739613310986","author":{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":12},{"type":0,"content":"Yeah, so they likely spawn a new Python process  in a virtual environment to execute every task. That is indeed very different from how it works in Infrahub today.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-11T11:17:09.654000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1382317732518957167","channel_id":"1316345739613310986","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":11},{"type":0,"content":"Sciencelogic which is a monitoring tool. It has a execution tool called powerflow which you can upload python tasks and its dependencies and when you upload it will install the dependencies on the worker. \n\nUnder the hood it actually created a virtual environment, installes the dependencies in the virtual environment and everytime the task is executed the workers know what virtual environment to activate to perform the task.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-11T11:11:09.803000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1382316223194202192","channel_id":"1316345739613310986","author":{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":10},{"type":0,"content":"<@227091130561331200> which application do you have in mind?","mentions":[{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-10T11:55:51.956000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381965085093662872","channel_id":"1316345739613310986","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":9},{"type":0,"content":"I have to think about it","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-10T11:04:57.735000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381952274762301470","channel_id":"1316345739613310986","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":8},{"type":0,"content":"Yea not sure what would be the best solution. And it needs to.work.with prefect. However I think I need to take a look at the docker pool. Somehow I would like to have dependency isolation for tasks but the approach you have is straightforward.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-10T11:03:41.411000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381951954636378172","channel_id":"1316345739613310986","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":7},{"type":0,"content":"I know of one commercial application that does in life package installation and updates but it works very differently.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-10T08:36:08.208000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381914821611491339","channel_id":"1316345739613310986","author":{"id":"227091130561331200","username":"minitriga.","avatar":"71ac6f8da9c358794381d5d430c53316","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Alex Gittings","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"Do you know of any other application that implements something like that? Also, when using this env var, would you expect the task-worker to install them when it starts? IE if you need to update a package, you would still need to restart the task worker(s)? Or do you have something else in mind?\n\nIf you want we can also schedule a call to discuss it more in depth.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-10T07:21:42.264000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381896090084704267","channel_id":"1316345739613310986","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":5},{"type":0,"content":"<@1221732604806692884> It was easy and works well for me: https://github.com/ubaumann/demo_infrahub_pydantify/blob/main/setup/docker-compose.override.yaml\nI was just thinking if I want to start a lab it could be nice if I have a ENV var I can set to install packaged. But for a stable setup the custom container is the preferred way.","mentions":[{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}}],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/ubaumann/demo_infrahub_pydantify/blob/main/setup/docker-compose.override.yaml","title":"demo_infrahub_pydantify/setup/docker-compose.override.yaml at main ...","description":"Simple example how infrahub can generate gNMI payload using pydantic models generated with pydantify - ubaumann/demo_infrahub_pydantify","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/53a1ec2363e8583d45082a1a6028fa38093b0b780c27f722ef0075a66b489f2f/ubaumann/demo_infrahub_pydantify","proxy_url":"https://images-ext-1.discordapp.net/external/4bVvZc9hkUouMGhQIiPenVeCMMm5LZRRH0e0957XlqM/https/opengraph.githubassets.com/53a1ec2363e8583d45082a1a6028fa38093b0b780c27f722ef0075a66b489f2f/ubaumann/demo_infrahub_pydantify","width":1200,"height":600,"description":"Simple example how infrahub can generate gNMI payload using pydantic models generated with pydantify - ubaumann/demo_infrahub_pydantify","flags":0},"content_scan_version":1}],"timestamp":"2025-06-10T06:48:37.570000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381887765674852464","channel_id":"1316345739613310986","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"<@867799355921268767> out of curiosity, do you see this as a pain point? Did you happen to have something else in mind?","mentions":[{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-10T05:24:21.486000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381866558921637908","channel_id":"1316345739613310986","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":19,"content":"Yes, this is still the recommended way.","mentions":[{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-09T19:55:12.103000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381723326027792567","channel_id":"1316345739613310986","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"message_reference":{"type":0,"channel_id":"1316345739613310986","message_id":"1381663270238163056","guild_id":"1212332642801025064"},"position":2,"reactions":[{"emoji":{"id":null,"name":"üëç"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}],"referenced_message":{"type":0,"content":"Just wondering if the custom docker is still the best way to install python packages","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-09T15:56:33.687000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381663270238163056","channel_id":"1316345739613310986","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1}},{"type":0,"content":"Just wondering if the custom docker is still the best way to install python packages","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-06-09T15:56:33.687000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1381663270238163056","channel_id":"1316345739613310986","author":{"id":"867799355921268767","username":"ubaumann","avatar":"6246a4fdf0eec315ad7d2a830626dc94","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"ubaumann","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"The best approach at this stage is to build a custom docker image that you then only use for the workers.\n\nIt is similar to how you can add custom CA certificates, which is documented here https://docs.infrahub.app/guides/repository#installing-custom-ca-certificates\n\nBut in your case, instead of copying in the files, you would install the dependency.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://docs.infrahub.app/guides/repository","title":"Adding external repositories | Infrahub Documentation","description":"Infrahub supports two different types of connections to external Git repositories:","content_scan_version":2}],"timestamp":"2024-12-11T10:12:09.670000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1316346783261130864","channel_id":"1316345739613310986","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"reactions":[{"emoji":{"id":null,"name":"üôå"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"We use the python package \"lxml\" in a Artifact ti generate netconf files. Apparently the infrahubTaskWorker (prefect worker pool) does not have that package installed. I solfed it with the workaround of inclouding it in the command of the docker-compose or in kubernetes: `infrahubTaskWorker:\n  replicas: 2\n  resources: {}\n  infrahubTaskWorker:\n    args:\n      - sh\n      - -c\n      - |\n        pip install lxml && \\\n        prefect worker start --type infrahubasync --pool infrahub-worker --with-healthcheck` which works,  but we were wondering, is there a bether way to do something like this?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2024-12-11T10:08:00.845000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1316345739613310986","channel_id":"1316345739613310986","author":{"id":"1300537046833692725","username":"simli133","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Simon linder","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"reactions":[{"emoji":{"id":null,"name":"üëç"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]}]}]