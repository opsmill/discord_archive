{"thread":{"id":"1395095301823660337","type":11,"last_message_id":"1397902036997115924","flags":0,"guild_id":"1212332642801025064","name":"Possible bug with a mutation query","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"655596743605485570","thread_metadata":{"archived":true,"archive_timestamp":"2025-08-23T11:33:16.201000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2025-07-16T17:30:39.572000+00:00"},"message_count":27,"member_count":2,"total_message_sent":27,"applied_tags":["1304062716125773886"]},"messages":[{"type":0,"content":"I'll try and see if i can recreate the setup again with a new prefix","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-24T11:23:37.384000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1397902036997115924","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":26},{"type":0,"content":"i recreated the ipv6 prefix and the allocation worked, not sure why it was not working in the first place","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-24T11:23:17.161000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1397901952175837324","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":25,"reactions":[{"emoji":{"id":null,"name":"üëç"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"<@1221732604806692884> sorry for the delay in respone, i finally managed to get it working","mentions":[{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-24T11:22:58.503000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1397901873918509156","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":24},{"type":0,"content":"hey <@1221732604806692884> i have not tried it again. Let me try and share the details","mentions":[{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-23T09:38:53.247000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1397513291550429245","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":23},{"type":0,"content":"<@655596743605485570> did you manage to try this again? If it doesn't work, can you maybe share the prefix and what has already been allocated?","mentions":[{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-21T14:50:17.195000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1396866881977323621","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":22},{"type":0,"content":"so i have a couple of /64 already allocated inside the /48 and that's it. Let me try the reservation thing again","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T09:24:35.305000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395697753753129020","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":21},{"type":0,"content":"Tried allocating /80 from an \"empty\" /48 prefix and that seems to work for me","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T08:58:26.420000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395691173372497930","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":20},{"type":0,"content":"It should be empty but let me check again","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T08:16:58.232000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395680737155612723","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":19},{"type":0,"content":"Hmm i tried this with a /48 in the pool and set the default_prefix_length to 80 and it seems to work\n\nYou can try yourself in the sandbox, by executing this mutation\n\n```mutation {\n  IPPrefixPoolGetResource(data: {\n    hfid: [\"test ipv6\"]\n  }) {\n    node {\n      id\n    }\n  }\n}\n```\n\nAre you sure there is enough space available to allocated another /80?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T07:48:17.943000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395673521740320828","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":18},{"type":0,"content":"I have set the default prefix length of 80 (don't ask me why 80, can explain another day). The pool has a single /48","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T07:30:11.045000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395668962959953972","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":17},{"type":0,"content":"https://github.com/opsmill/infrahub/issues/6855","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/opsmill/infrahub/issues/6855","title":"bug: cannot query utilization details of an IP prefix pool with a \"...","description":"Component API Server / GraphQL Infrahub version 1.3.3 Current Behavior You cannot query the utilization details of an IP prefix resource pool, when there is a large IPv6 prefix attached as a resour...","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/fc3d728e3b5cb887af2e48840e6c768501e4d8855c2a01d064e081bf78ec6e5e/opsmill/infrahub/issues/6855","proxy_url":"https://images-ext-1.discordapp.net/external/GOyliLUZ_UWOzIjtXET_UEYvpu8v9xp3FPREVyveUyU/https/opengraph.githubassets.com/fc3d728e3b5cb887af2e48840e6c768501e4d8855c2a01d064e081bf78ec6e5e/opsmill/infrahub/issues/6855","width":1200,"height":600,"description":"Component API Server / GraphQL Infrahub version 1.3.3 Current Behavior You cannot query the utilization details of an IP prefix resource pool, when there is a large IPv6 prefix attached as a resour...","flags":0},"content_scan_version":2}],"timestamp":"2025-07-18T07:13:18.481000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395664715958583327","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":16},{"type":0,"content":"I created a /48 prefix and attached a pool to it. I have set the default prefix length to /64 and I can create new prefix resources with the IPPrefixPoolGetResource mutation.\n\nFor you pool, can you have a look at what prefix length the attached resources have? And what is the prefix length you are requesting when you perform the mutation?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T07:00:23.620000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395661465956122634","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":15},{"type":0,"content":"I'll create an issue for that one","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T06:58:18.754000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395660942229897216","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":14},{"type":0,"content":"It comes from this query performed by the frontend\n\n```graphql\nquery GET_RESOURCE_POOL_UTILIZATION($poolId: String!) {\n  InfrahubResourcePoolUtilization(pool_id: $poolId) {\n    edges {\n      node {\n        id\n        display_label\n        kind\n        weight\n        utilization\n        utilization_branches\n        utilization_default_branch\n        __typename\n      }\n      __typename\n    }\n    count\n    utilization\n    utilization_branches\n    utilization_default_branch\n    __typename\n  }\n}\n```\nWhen you create a /48 prefix that is used by a pool, it would mean you have `1.208.925.819.614.629.174.706.176` addresses available. We seem to try to store that number in a 32-bit integer type, which is not going to work ofc","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T06:57:59.873000+00:00","edited_timestamp":"2025-07-18T06:58:10.489000+00:00","flags":0,"components":[],"id":"1395660863037378691","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":13},{"type":0,"content":"Ok, I was able to reproduce this one:\n```\nInt cannot represent non 32-bit signed integer value: <ipv6 address to decimal value>\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T06:55:22.309000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395660202165927948","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":12},{"type":0,"content":"Our sandbox contains an IPv6  prefix pool and the details seem to displayed correctly:\nhttps://sandbox.infrahub.app/resource-manager/1808d319-ff7b-72d8-d0e9-c5108db9b10e/resources/1808d319-e696-8efd-d0ef-c515ff3a47d8?branch=main\n\nAnd creating a new IPv6 prefix from the pool using the IPPrefixPoolGetResource mutation seems to work\n```graphql\nmutation MyMutation {\n  IPPrefixPoolGetResource(\n    data: {\n      hfid: [\"Internal networks pool (IPv6)\"]\n      data: {description: \"testing\"}\n      prefix_length: 120\n    }\n  ) {\n    ok\n  }\n}\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"link","url":"https://sandbox.infrahub.app/resource-manager/1808d319-ff7b-72d8-d0e9-c5108db9b10e/resources/1808d319-e696-8efd-d0ef-c515ff3a47d8?branch=main","title":"Infrahub","description":"Unleash the full power of infrastructure automation","content_scan_version":2}],"timestamp":"2025-07-18T06:43:43.810000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395657272448778362","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":11},{"type":0,"content":"Hmmm","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-18T06:41:26.143000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395656695031529555","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":10},{"type":0,"content":"Another bummer, can't get any ipv6 resources from the pool, i seem to only get the below error for any prefix-length for a ipv6 pool with /48\n\n```\n{\n  \"data\": {\n    \"IPPrefixPoolGetResource\": null\n  },\n  \"errors\": [\n    {\n      \"message\": \"No more resources available\",\n      \"locations\": [\n        {\n          \"line\": 7,\n          \"column\": 3\n        }\n      ],\n      \"path\": [\n        \"IPPrefixPoolGetResource\"\n      ]\n    }\n  ]\n}\n```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-17T22:54:14.775000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395539122952868041","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":9},{"type":0,"content":"Hey Wim, seems CoreIPPrefixPool does support v6 pools but the UI can't display the details. The UI complains about the type as below. I can fetch the pool just fine via graphql \n\n`Int cannot represent non 32-bit signed integer value: <ipv6 address to decimal value>`","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-17T22:42:13.942000+00:00","edited_timestamp":"2025-07-17T22:42:28.876000+00:00","flags":0,"components":[],"id":"1395536099560128522","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":8},{"type":0,"content":"Thanks a lot Wim","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-17T22:02:11.691000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395526023788892180","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":7},{"type":0,"content":"I have opened this issue for it:\nhttps://github.com/opsmill/infrahub/issues/6850","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://github.com/opsmill/infrahub/issues/6850","title":"bug: cannot use a variable in the data property of IPPrefixPoolGetR...","description":"Component API Server / GraphQL Infrahub version 1.3.3 Current Behavior When you use a variable in the data property of the data argument used in the IPPrefixPoolGetResource GraphQL mutation, to set...","color":1975079,"provider":{"name":"GitHub"},"thumbnail":{"url":"https://opengraph.githubassets.com/71e9e8c0a97d1fddab98e94767f930d112135365f7192ccba242232ee5ae7dec/opsmill/infrahub/issues/6850","proxy_url":"https://images-ext-1.discordapp.net/external/Wyld14y3Tzzv3ADRxIi0W26ddrYUppWZjjchuZ-OOrE/https/opengraph.githubassets.com/71e9e8c0a97d1fddab98e94767f930d112135365f7192ccba242232ee5ae7dec/opsmill/infrahub/issues/6850","width":1200,"height":600,"content_type":"image/png","placeholder":"+vcFDIKGiZiJiHiYZ39anmD5Jg==","placeholder_version":1,"flags":0},"content_scan_version":2}],"timestamp":"2025-07-17T20:28:24.164000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395502420229886062","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":6},{"type":0,"content":"I'll have a look","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-17T14:20:38.115000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395409868512297012","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":5,"reactions":[{"emoji":{"id":null,"name":"üëç"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"So i tried using `IPPrefixPoolGetResource` mutation and it does have the same error as the `from_pool` where the mutation variables are not carried over to the inner data object","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-17T13:57:32.889000+00:00","edited_timestamp":"2025-07-17T13:57:51.285000+00:00","flags":0,"components":[],"id":"1395404058453475418","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":4},{"type":0,"content":"Yeah that makes sense to me but I see an issue with the mutation query for the second case (from_pool) where the inner data dictionary cant use any variables","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-17T10:49:01.756000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395356616123093022","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"It's a bit confusing I guess, but if you just want to create a prefix from a pool then you have to use the ` IPPrefixPoolGetResource` mutation and the result will be the new IP prefix object.\n\nIf you want to create another object, that is going to have an IP prefix assigned to it as a relationship, but the prefix should come from a pool, then you can use the `from_pool` resolver in the `create` `update` or `upsert` mutatio nof that object.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-17T09:55:47.382000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395343217947312168","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"Thanks Wim, so I was using this as my base example where you can do it for some type of service construct/schema instead of direct allocation.\n\nIf I pass an actual string to the name key inside the second data dictionary it does seem to work.\n\nhttps://docs.infrahub.app/guides/resource-manager#:~:text=In%20this%20mutation%20we%20use%20the%20from_pool%20resolver%20to%20indicate%20we%20want%20to%20allocate%20a%20assigned_prefix%20from%20a%20resource%20pool.%20Replace%20the%20id%20with%20the%20id%20of%20the%20CoreIPPrefixPool%20we%20created%20previously.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[{"type":"article","url":"https://docs.infrahub.app/guides/resource-manager","title":"Using Resource Managers | Infrahub Documentation","description":"The goal of this guide is to show you how to create a resource pool, and how you can allocate resources using them.","content_scan_version":0}],"timestamp":"2025-07-17T08:59:35.511000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395329075295551489","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"If you want to create a prefix from a CoreIPPrefixPool, you will have to use the  `IPPrefixPoolGetResource` mutation.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-16T21:57:06.707000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395162356727812169","channel_id":"1395095301823660337","author":{"id":"1221732604806692884","username":"w_vandeun","avatar":"e9ac2093c5e49a4a05a41b375db9ac69","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Wim","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"So i am writing a mutation query to use the IPPrefixPool resource manager for allocating a new prefix for a customer but it seems that the variable names passed to the query are not resolved correctly for the inner data dictionary.\n\n```mutation PrefixCreate(\n  $service_name: String!\n  $pool_id: String!\n  $location: String!\n) {\n  InfraPrefixCreate(\n    data: {\n      name: {value: $service_name}\n      prefix: {\n        from_pool: {\n          id: $pool_id\n          data: {\n            name: $service_name             ---->> this is not getting resolved\n            organization: \"foobar\"\n            role: \"foo\"\n            location: $location\n            description: $service_name\n          }\n        }\n      }\n    }\n  ) {\n    ok\n    object {\n      display_label\n      prefix {\n        node {\n          prefix {\n            value\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nNow if i pass in the 3 variables either via the API or the graphql explorer, the `name` key within the inner data dictionary is not resolved and I get an error which rightly says that I can't create a prefix without a name.\n\n```{\n  \"data\": {\n    \"InfraPrefixCreate\": null\n  },\n  \"errors\": [\n    {\n      \"message\": \"IPPrefixPool: foo-private-vip-pool | A value must be provided for name at name\",\n      \"locations\": [\n        {\n          \"line\": 6,\n          \"column\": 3\n        }\n      ],\n      \"path\": [\n        \"InfraPrefixCreate\"\n      ]\n    }\n  ]\n}```","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2025-07-16T17:30:39.572000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1395095301823660337","channel_id":"1395095301823660337","author":{"id":"655596743605485570","username":"overloadbit","avatar":null,"discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"overloadbit","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}