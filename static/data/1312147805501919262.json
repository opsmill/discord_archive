[{"thread":{"id":"1312147805501919262","type":11,"last_message_id":"1312785704899575870","flags":0,"guild_id":"1212332642801025064","name":"Computed Attributes: external lookups?","parent_id":"1301914405176475729","rate_limit_per_user":0,"bitrate":64000,"user_limit":0,"rtc_region":null,"owner_id":"1033714246774706206","thread_metadata":{"archived":true,"archive_timestamp":"2024-12-31T14:29:47.681000+00:00","auto_archive_duration":4320,"locked":false,"create_timestamp":"2024-11-29T20:06:55.359000+00:00"},"message_count":5,"member_count":2,"total_message_sent":5,"applied_tags":["1301915943663960064","1301916056205656276","1304062588858007572"]},"messages":[{"type":0,"content":"2/ I like the idea very much ... I hope we'll be able to get to it at some point,","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2024-12-01T14:21:42.427000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1312785704899575870","channel_id":"1312147805501919262","author":{"id":"695690467056025690","username":"dgarros","avatar":"67171294847dca2ce3ac938f5bca0443","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Damien","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":4,"reactions":[{"emoji":{"id":null,"name":"üëç"},"count":1,"count_details":{"burst":0,"normal":1},"burst_colors":[],"me_burst":false,"burst_me":false,"me":false,"burst_count":0}]},{"type":0,"content":"1/ this isn't supported yet but it makes a lot of sense. We are currently in the redesign of the entire event notification system, once this is done we should look into this.","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2024-12-01T14:19:58.361000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1312785268415397958","channel_id":"1312147805501919262","author":{"id":"695690467056025690","username":"dgarros","avatar":"67171294847dca2ce3ac938f5bca0443","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Damien","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":3},{"type":0,"content":"Thanks <@695690467056025690> for your extensive reply. Let me continue in two directions:\n1) assuming computed attributes as outlined above: infrahub needs to be aware of all the datapoints involved of a CA to update the cache upon changing of any of them. \nWould the event notification system allow an external system to notify infrahub when it catches a change? Some sort of inbound webhook or publish to the servicebus, to allow infrahub to keep its strong data management properties for external lookups. This would probably have limited scale, eg not update every second if we‚Äôre talking about network usage statistics. But might be useful for the keyvault use case or bgp session state.\n2) assuming an external tsdb that has a time based knowledge of network state info. If that system has a graphql api, we could form a graphql federation between infrahub and the ‚Äòstate hub‚Äô. With a federation we‚Äôd link the two schemas to allow one graphql api to anwer both desired state and running state attributes, linking from the respective authoritative backend. I think infrahub has a great potential to be the unified gateway for this use case.","mentions":[{"id":"695690467056025690","username":"dgarros","avatar":"67171294847dca2ce3ac938f5bca0443","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Damien","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2024-12-01T11:00:34.998000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1312735090433855509","channel_id":"1312147805501919262","author":{"id":"1033714246774706206","username":"sdktr","avatar":"9ee9b95b734aa5beefcd1f92c99b08b0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Stefan de Kooter","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false,"position":2},{"type":0,"content":"While I completely understand the value of the use cases you described, I think there are many benefits of caching the value of the computed attribute instead of rendering it on the fly. to name a few\n- We can rely on it, we can build on top of it, meaning we can use it for mandatory attributes etc ..\n- Attribute with computed value remain searchable \n- We can provide a reliable pipeline\n- We can guarantee that the database is immutable and we can still provide an accurate history","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2024-11-30T15:23:10.498000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1312438785925054615","channel_id":"1312147805501919262","author":{"id":"695690467056025690","username":"dgarros","avatar":"67171294847dca2ce3ac938f5bca0443","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Damien","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false,"position":1},{"type":0,"content":"hey <@1033714246774706206> it's interesting to see the use cases you have in mind for the computed attribute\nI think neither of them is really a good fit for what we are building.\nMy guess is you might be thinking of the computed attribute the way they are implemented in Nautobot where the value is rendered when you access it.\nIn Infrahub, we decided to do it differently, the value of a computed attribute is computed early on and we are \"caching\" it (store in the database).\nWe have some mechanisms in place that will automatically detect if the value of a computed attribute needs to be updated or not based on all the event happening in the system.","mentions":[{"id":"1033714246774706206","username":"sdktr","avatar":"9ee9b95b734aa5beefcd1f92c99b08b0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Stefan de Kooter","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null}],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2024-11-30T15:22:57.367000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1312438730849783888","channel_id":"1312147805501919262","author":{"id":"695690467056025690","username":"dgarros","avatar":"67171294847dca2ce3ac938f5bca0443","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Damien","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"},"primary_guild":{"identity_guild_id":"1212332642801025064","identity_enabled":true,"tag":"OTTO","badge":"40122d86938d2a7824dfd9bd695abe81"}},"pinned":false,"mention_everyone":false,"tts":false},{"type":0,"content":"This question is about the way Computed Attributes are intended to be used/will be suitable for using:\n1) External Vault Secret lookups: \nDefine the actual content of a secret in an external Vault system, but use the infrahub gql to get this content as part of response. In the outbound request to the external vault, include the requesting context (user doing the request, some node details etc.). Optionally apply an encryption/hashing function to comply with the intended usage.\n\n2) External *State* lookup\nAssuming some external TSDB system that can present a simple 'up/down' output when queried for an Interface State. Could we make a Computed Attribute under a node in Infrahub, that resolves to this external system to output live state info in the same output as the 'desired' state from Infrahub?","mentions":[],"mention_roles":[],"attachments":[],"embeds":[],"timestamp":"2024-11-29T20:06:55.359000+00:00","edited_timestamp":null,"flags":0,"components":[],"id":"1312147805501919262","channel_id":"1312147805501919262","author":{"id":"1033714246774706206","username":"sdktr","avatar":"9ee9b95b734aa5beefcd1f92c99b08b0","discriminator":"0","public_flags":0,"flags":0,"banner":null,"accent_color":null,"global_name":"Stefan de Kooter","avatar_decoration_data":null,"collectibles":null,"display_name_styles":null,"banner_color":null,"clan":null,"primary_guild":null},"pinned":false,"mention_everyone":false,"tts":false}]}]